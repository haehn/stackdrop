/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var m=void 0,n=!0,p=null,r=!1;function ba(){return function(){}}function s(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var y,ca=this;function da(){}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ga(a){return a!==m}function B(a){return a!=p}function C(a){return"array"==ea(a)}function ha(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ia(a){return"string"==typeof a}function E(a){return"number"==typeof a}function ja(a){return"function"==ea(a)}function ka(a){a=ea(a);return"object"==a||"array"==a||"function"==a}function la(a){return a[ma]||(a[ma]=++na)}
var ma="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),na=0;function oa(a,b,c){return a.call.apply(a.bind,arguments)}function pa(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ra(a,b,c){ra=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oa:pa;return ra.apply(p,arguments)}function sa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ta=Date.now||function(){return+new Date};
function G(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ga(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function H(a,b){function c(){}c.prototype=b.prototype;a.j=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ua(a,b,c){this.Ba=this.Aa=this.za=0;3==arguments.length?(this.za=Number(a),this.Aa=Number(b),this.Ba=Number(c)):a instanceof ua?(this.za=Number(a.x()),this.Aa=Number(a.y()),this.Ba=Number(a.b())):(this.za=Number(a[0]),this.Aa=Number(a[1]),this.Ba=Number(a[2]))}
ua.prototype={f:function(){return new ua(this.za,this.Aa,this.Ba)},df:function(){return new ua(-this.za,-this.Aa,-this.Ba)},yc:function(a){return new ua(this.za+a.x(),this.Aa+a.y(),this.Ba+a.b())},fd:function(a){return new ua(this.za-a.x(),this.Aa-a.y(),this.Ba-a.b())},Gb:function(a){return new ua(this.za*a,this.Aa*a,this.Ba*a)},wh:function(a){return new ua(this.za/a,this.Aa/a,this.Ba/a)},vc:function(a){return this.za*a.x()+this.Aa*a.y()+this.Ba*a.b()},pg:function(a,b){return this.yc(a.fd(this).Gb(b))},
length:function(){return Math.sqrt(this.vc(this))},nd:function(){return this.wh(this.length())},Oe:function(a){return new ua(this.Aa*a.b()-this.Ba*a.y(),this.Ba*a.x()-this.za*a.b(),this.za*a.y()-this.Aa*a.x())},x:t("za"),y:t("Aa"),b:t("Ba")};var I=I||{};I.rj=n;I.Ia=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.Ca=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.dh=0;this.nj=function(){return this.dh++}};function va(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}var wa=window.Vg;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.jd;++c)window.jd=window[b[c]+"RequestAnimationFrame"],window.Jd=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.jd||(window.jd=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.Jd||(window.Jd=function(a){clearTimeout(a)})})();
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===m&&i(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d});G("$",wa);G("Function.prototype.bind",Function.prototype.bind);
G("window.requestAnimationFrame",window.jd);G("window.cancelAnimationFrame",window.Jd);function ya(a){if(!za.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Aa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ba,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ca,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Da,"&quot;"));return a}var Aa=/&/g,Ba=/</g,Ca=/>/g,Da=/\"/g,za=/[&<>\"]/;var Ea,Fa,Ia,Ja,Ka,La,Ma;function Pa(){return ca.navigator?ca.navigator.userAgent:p}function Qa(){return ca.navigator}Ka=Ja=Ia=Fa=Ea=r;var Ra;if(Ra=Pa()){var Sa=Qa();Ea=0==Ra.indexOf("Opera");Fa=!Ea&&-1!=Ra.indexOf("MSIE");Ja=(Ia=!Ea&&-1!=Ra.indexOf("WebKit"))&&-1!=Ra.indexOf("Mobile");Ka=!Ea&&!Ia&&"Gecko"==Sa.product}var Ta=Ea,Ua=Fa,Va=Ka,Wa=Ia,Ya=Ja,Za,$a=Qa();Za=$a&&$a.platform||"";La=-1!=Za.indexOf("Mac");Ma=-1!=Za.indexOf("Win");var ab=!!Qa()&&-1!=(Qa().appVersion||"").indexOf("X11"),bb;
a:{var cb="",db;if(Ta&&ca.opera)var eb=ca.opera.version,cb="function"==typeof eb?eb():eb;else if(Va?db=/rv\:([^\);]+)(\)|;)/:Ua?db=/MSIE\s+([^\);]+)(\)|;)/:Wa&&(db=/WebKit\/(\S+)/),db)var fb=db.exec(Pa()),cb=fb?fb[1]:"";if(Ua){var hb,ib=ca.document;hb=ib?ib.documentMode:m;if(hb>parseFloat(cb)){bb=""+hb;break a}}bb=cb}var jb={};
function lb(a){var b;if(!(b=jb[a])){b=0;for(var c=(""+bb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var k=j.exec(g)||["","",""],o=l.exec(h)||["","",""];if(0==k[0].length&&0==o[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==o[1].length?0:parseInt(o[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==o[1].length?0:parseInt(o[1],10))?1:0)||((0==k[2].length)<(0==o[2].length)?-1:(0==k[2].length)>(0==o[2].length)?1:0)||(k[2]<o[2]?-1:k[2]>o[2]?1:0)}while(0==b)}b=jb[a]=0<=b}return b}var mb={};function nb(a){return mb[a]||(mb[a]=Ua&&document.documentMode&&document.documentMode>=a)};function ob(a,b){for(var c in a)b.call(m,a[c],c,a)}function pb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function qb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var rb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function sb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<rb.length;f++)c=rb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var tb=Array.prototype,wb=tb.indexOf?function(a,b,c){return tb.indexOf.call(a,b,c)}:function(a,b,c){c=c==p?0:0>c?Math.max(0,a.length+c):c;if(ia(a))return!ia(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=tb.forEach?function(a,b,c){tb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},yb=tb.map?function(a,b,c){return tb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ia(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},zb=tb.some?function(a,b,c){return tb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return n;return r},Ab=tb.every?function(a,b,c){return tb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ia(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return n};function Bb(a,b){var c=wb(a,b);0<=c&&tb.splice.call(a,c,1)}
function Cb(a){return tb.concat.apply(tb,arguments)}function Db(a){if(C(a))return Cb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Eb(a,b,c){return 2>=arguments.length?tb.slice.call(a,b):tb.slice.call(a,b,c)};function Fb(a){if("function"==typeof a.bb)a=a.bb();else if(ha(a)||ia(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Gb(a){if("function"==typeof a.Pa)return a.Pa();if(ia(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return pb(a)}
function Hb(a,b){if("function"==typeof a.every)return a.every(b,m);if(ha(a)||ia(a))return Ab(a,b,m);var c;if("function"==typeof a.bd)c=a.bd();else if("function"!=typeof a.Pa)if(ha(a)||ia(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=qb(a);else c=m;for(var d=Gb(a),e=d.length,f=0;f<e;f++)if(!b.call(m,d[f],c&&c[f],a))return r;return n};var Ib="StopIteration"in ca?ca.StopIteration:Error("StopIteration");function Jb(){}Jb.prototype.next=function(){i(Ib)};Jb.prototype.Ec=function(){return this};function Kb(a){if(a instanceof Jb)return a;if("function"==typeof a.Ec)return a.Ec(r);if(ha(a)){var b=0,c=new Jb;c.next=function(){for(;;){b>=a.length&&i(Ib);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Nb(a,b){if(ha(a))try{xb(a,b,m)}catch(c){c!==Ib&&i(c)}else{a=Kb(a);try{for(;;)b.call(m,a.next(),m,a)}catch(d){d!==Ib&&i(d)}}};function Ob(a,b){this.F={};this.z=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.He(a)}y=Ob.prototype;y.O=0;y.od=0;y.bb=t("O");y.Pa=function(){Pb(this);for(var a=[],b=0;b<this.z.length;b++)a.push(this.F[this.z[b]]);return a};y.bd=function(){Pb(this);return this.z.concat()};y.Me=function(a){for(var b=0;b<this.z.length;b++){var c=this.z[b];if(Qb(this.F,c)&&this.F[c]==a)return n}return r};
y.Yc=function(a,b){if(this===a)return n;if(this.O!=a.bb())return r;var c=b||Rb;Pb(this);for(var d,e=0;d=this.z[e];e++)if(!c(this.get(d),a.get(d)))return r;return n};function Rb(a,b){return a===b}y.clear=function(){this.F={};this.od=this.O=this.z.length=0};y.remove=function(a){return Qb(this.F,a)?(delete this.F[a],this.O--,this.od++,this.z.length>2*this.O&&Pb(this),n):r};
function Pb(a){if(a.O!=a.z.length){for(var b=0,c=0;b<a.z.length;){var d=a.z[b];Qb(a.F,d)&&(a.z[c++]=d);b++}a.z.length=c}if(a.O!=a.z.length){for(var e={},c=b=0;b<a.z.length;)d=a.z[b],Qb(e,d)||(a.z[c++]=d,e[d]=1),b++;a.z.length=c}}y.get=function(a,b){return Qb(this.F,a)?this.F[a]:b};y.set=function(a,b){Qb(this.F,a)||(this.O++,this.z.push(a),this.od++);this.F[a]=b};y.He=function(a){var b;a instanceof Ob?(b=a.bd(),a=a.Pa()):(b=qb(a),a=pb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};y.f=function(){return new Ob(this)};
y.Ec=function(a){Pb(this);var b=0,c=this.z,d=this.F,e=this.od,f=this,g=new Jb;g.next=function(){for(;;){e!=f.od&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Ib);var g=c[b++];return a?g:d[g]}};return g};function Qb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Sb(a){this.F=new Ob;a&&this.He(a)}function Tb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+la(a):b.substr(0,1)+a}y=Sb.prototype;y.bb=function(){return this.F.bb()};y.add=function(a){this.F.set(Tb(a),a)};y.He=function(a){for(var a=Gb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};y.$d=function(a){for(var a=Gb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};y.remove=function(a){return this.F.remove(Tb(a))};y.clear=function(){this.F.clear()};
y.contains=function(a){a=Tb(a);return Qb(this.F.F,a)};y.lg=function(a){for(var b=new Sb,a=Gb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};y.Pa=function(){return this.F.Pa()};y.f=function(){return new Sb(this)};y.Yc=function(a){return this.bb()==Fb(a)&&Ub(this,a)};
function Ub(a,b){var c=Fb(b);if(a.bb()>c)return r;!(b instanceof Sb)&&5<c&&(b=new Sb(b));return Hb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Me)a=b.Me(a);else if(ha(b)||ia(b))a=0<=wb(b,a);else a:{for(var c in b)if(b[c]==a){a=n;break a}a=r}return a})}y.Ec=function(){return this.F.Ec(r)};function Vb(){}Vb.prototype.$f=r;Vb.prototype.Oa=function(){this.$f||(this.$f=n,this.P())};Vb.prototype.P=function(){this.th&&Wb.apply(p,this.th)};function Xb(a){a&&"function"==typeof a.Oa&&a.Oa()}function Wb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ha(d)?Wb.apply(p,d):Xb(d)}};function Yb(a,b){this.rg=b;this.ad=[];a>this.rg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.ad.push(this.Ld())}H(Yb,Vb);y=Yb.prototype;y.Xf=p;y.Zf=p;function Zb(a,b){a.ad.length<a.rg?a.ad.push(b):a.Re(b)}y.Ld=function(){return this.Xf?this.Xf():{}};y.Re=function(a){if(this.Zf)this.Zf(a);else if(ka(a))if(ja(a.Oa))a.Oa();else for(var b in a)delete a[b]};y.P=function(){Yb.j.P.call(this);for(var a=this.ad;a.length;)this.Re(a.pop());delete this.ad};function $b(){this.Zc=[];this.kf=new Ob;this.Og=this.Pg=this.Qg=this.Lg=0;this.md=new Ob;this.Uf=this.Ng=0;this.ef=1;this.Se=new Yb(0,4E3);this.Se.Ld=function(){return new ac};this.Mg=new Yb(0,50);this.Mg.Ld=function(){return new bc};var a=this;this.Ve=new Yb(0,2E3);this.Ve.Ld=function(){return""+a.ef++};this.Ve.Re=ba()}function bc(){this.xf=this.time=this.count=0}
bc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.xf&&a.push(" [VarAlloc = ",this.xf,"]");return a.join("")};function ac(){}function cc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(dc(a.ag-c));e.push(" ",ec(a.ag-b));0==a.Te?e.push(" Start        "):1==a.Te?(e.push(" Done "),e.push(dc(a.jk-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.jj&&e.push("[VarAlloc ",a.jj,"] ");return e.join("")}
ac.prototype.toString=function(){return this.type==p?this.qh:"["+this.type+"] "+this.qh};$b.prototype.reset=function(){for(var a=0;a<this.Zc.length;a++){var b=this.Se.id;b&&Zb(this.Ve,b);Zb(this.Se,this.Zc[a])}this.Zc.length=0;this.kf.clear();this.Lg=ta();this.Uf=this.Ng=this.Og=this.Pg=this.Qg=0;b=this.md.bd();for(a=0;a<b.length;a++){var c=this.md.get(b[a]);c.count=0;c.time=0;c.xf=0;Zb(this.Mg,c)}this.md.clear()};
$b.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Zc.length;d++){var e=this.Zc[d];1==e.Te&&c.pop();a.push(" ",cc(e,this.Lg,b,c.join("")));b=e.ag;a.push("\n");0==e.Te&&c.push("|  ")}if(0!=this.kf.bb()){var f=ta();a.push(" Unstopped timers:\n");Nb(this.kf,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",ec(b.startTime),")\n")})}b=this.md.bd();for(d=0;d<b.length;d++)c=this.md.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Ng,"\n","Total comments created ",
this.Uf,"\n","Overhead start: ",this.Qg," ms\n","Overhead end: ",this.Pg," ms\n","Overhead comment: ",this.Og," ms\n");return a.join("")};function dc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function ec(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new $b;function fc(){}var gc=0;y=fc.prototype;y.key=0;y.Ac=r;y.Je=r;y.ja=function(a,b,c,d,e,f){ja(a)?this.mg=n:a&&a.handleEvent&&ja(a.handleEvent)?this.mg=r:i(Error("Invalid listener argument"));this.dd=a;this.Gg=b;this.src=c;this.type=d;this.capture=!!e;this.Ue=f;this.Je=r;this.key=++gc;this.Ac=r};y.handleEvent=function(a){return this.mg?this.dd.call(this.Ue||this.src,a):this.dd.handleEvent.call(this.dd,a)};!Ua||nb(9);var hc=!Ua||nb(9),ic=Ua&&!lb("8");!Wa||lb("528");Va&&lb("1.9b")||Ua&&lb("8")||Ta&&lb("9.5")||Wa&&lb("528");!Va||lb("8");function jc(a,b){this.type=a;this.currentTarget=this.target=b}H(jc,Vb);y=jc.prototype;y.P=function(){delete this.type;delete this.target;delete this.currentTarget};y.ec=r;y.kd=n;y.stopPropagation=function(){this.ec=n};y.preventDefault=function(){this.kd=r};function kc(a){kc[" "](a);return a}kc[" "]=da;function lc(a,b){a&&this.ja(a,b)}H(lc,jc);y=lc.prototype;y.target=p;y.relatedTarget=p;y.offsetX=0;y.offsetY=0;y.clientX=0;y.clientY=0;y.screenX=0;y.screenY=0;y.button=0;y.keyCode=0;y.charCode=0;y.ctrlKey=r;y.altKey=r;y.shiftKey=r;y.metaKey=r;y.Ea=p;
y.ja=function(a,b){var c=this.type=a.type;jc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Va){var e;a:{try{kc(d.nodeName);e=n;break a}catch(f){}e=r}e||(d=p)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Wa||a.offsetX!==m?a.offsetX:a.layerX;this.offsetY=Wa||a.offsetY!==m?a.offsetY:a.layerY;this.clientX=a.clientX!==m?a.clientX:a.pageX;this.clientY=a.clientY!==m?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ea=a;delete this.kd;delete this.ec};y.stopPropagation=function(){lc.j.stopPropagation.call(this);this.Ea.stopPropagation?this.Ea.stopPropagation():this.Ea.cancelBubble=n};
y.preventDefault=function(){lc.j.preventDefault.call(this);var a=this.Ea;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,ic)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};y.Fh=t("Ea");y.P=function(){lc.j.P.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ea=p};var mc={},nc={},oc={},pc={};
function K(a,b,c,d,e){if(b){if(C(b)){for(var f=0;f<b.length;f++)K(a,b[f],c,d,e);return p}var d=!!d,g=nc;b in g||(g[b]={O:0,Ga:0});g=g[b];d in g||(g[d]={O:0,Ga:0},g.O++);var g=g[d],h=la(a),j;g.Ga++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.dd==c&&g.Ue==e){if(g.Ac)break;return j[f].key}}else j=g[h]=[],g.O++;f=qc();f.src=a;g=new fc;g.ja(c,f,a,b,d,e);c=g.key;f.key=c;j.push(g);mc[c]=g;oc[h]||(oc[h]=[]);oc[h].push(g);a.addEventListener?(a==ca||!a.Yf)&&a.addEventListener(b,f,d):a.attachEvent(b in
pc?pc[b]:pc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function qc(){var a=rc,b=hc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function sc(a,b,c,d,e){if(C(b))for(var f=0;f<b.length;f++)sc(a,b[f],c,d,e);else a=K(a,b,c,d,e),mc[a].Je=n}
function tc(a,b,c,d,e){if(C(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,e);else{d=!!d;a:{f=nc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=la(a),f[a]))){a=f[a];break a}a=p}if(a)for(f=0;f<a.length;f++)if(a[f].dd==c&&a[f].capture==d&&a[f].Ue==e){uc(a[f].key);break}}}
function uc(a){if(!mc[a])return r;var b=mc[a];if(b.Ac)return r;var c=b.src,d=b.type,e=b.Gg,f=b.capture;c.removeEventListener?(c==ca||!c.Yf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in pc?pc[d]:pc[d]="on"+d,e);c=la(c);e=nc[d][f][c];if(oc[c]){var g=oc[c];Bb(g,b);0==g.length&&delete oc[c]}b.Ac=n;e.vg=n;vc(d,f,c,e);delete mc[a];return n}
function vc(a,b,c,d){if(!d.Wd&&d.vg){for(var e=0,f=0;e<d.length;e++)d[e].Ac?d[e].Gg.src=p:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.vg=r;0==f&&(delete nc[a][b][c],nc[a][b].O--,0==nc[a][b].O&&(delete nc[a][b],nc[a].O--),0==nc[a].O&&delete nc[a])}}function wc(a){var b,c=0,d=b==p;b=!!b;if(a==p)ob(oc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)uc(f.key),c++}});else if(a=la(a),oc[a])for(var a=oc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)uc(f.key),c++}}
function xc(a){var b=yc,a=la(a),c=oc[a];if(c){var d=ga(b),e=ga(m);return d&&e?(c=nc[b],!!c&&!!c[m]&&a in c[m]):!d&&!e?n:zb(c,function(a){return d&&a.type==b||e&&a.capture==m})}return r}function zc(a,b,c,d,e){var f=1,b=la(b);if(a[b]){a.Ga--;a=a[b];a.Wd?a.Wd++:a.Wd=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.Ac&&(f&=Ac(j,e)!==r)}}finally{a.Wd--,vc(c,d,b,a)}}return Boolean(f)}function Ac(a,b){var c=a.handleEvent(b);a.Je&&uc(a.key);return c}
function rc(a,b){if(!mc[a])return n;var c=mc[a],d=c.type,e=nc;if(!(d in e))return n;var e=e[d],f,g;if(!hc){var h;if(!(h=b))a:{h=["window","event"];for(var j=ca;f=h.shift();)if(B(j[f]))j=j[f];else{h=p;break a}h=j}f=h;h=n in e;j=r in e;if(h){if(0>f.keyCode||f.returnValue!=m)return n;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(k){l=n}if(l||f.returnValue==m)f.returnValue=n}}l=new lc;l.ja(f,this);f=n;try{if(h){for(var o=[],v=l.currentTarget;v;v=v.parentNode)o.push(v);g=e[n];g.Ga=g.O;for(var q=
o.length-1;!l.ec&&0<=q&&g.Ga;q--)l.currentTarget=o[q],f&=zc(g,o[q],d,n,l);if(j){g=e[r];g.Ga=g.O;for(q=0;!l.ec&&q<o.length&&g.Ga;q++)l.currentTarget=o[q],f&=zc(g,o[q],d,r,l)}}else f=Ac(c,l)}finally{o&&(o.length=0),l.Oa()}return f}d=new lc(b,this);try{f=Ac(c,d)}finally{d.Oa()}return f}var Bc=0;function Cc(a){return a+"_"+Bc++};function Dc(){}H(Dc,Vb);y=Dc.prototype;y.Yf=n;y.Yd=p;y.nf=s("Yd");y.addEventListener=function(a,b,c,d){K(this,a,b,c,d)};y.removeEventListener=function(a,b,c,d){tc(this,a,b,c,d)};
y.dispatchEvent=function(a){var b=a.type||a,c=nc;if(b in c){if(ia(a))a=new jc(a,this);else if(a instanceof jc)a.target=a.target||this;else{var d=a,a=new jc(b,this);sb(a,d)}var d=1,e,c=c[b],b=n in c,f;if(b){e=[];for(f=this;f;f=f.Yd)e.push(f);f=c[n];f.Ga=f.O;for(var g=e.length-1;!a.ec&&0<=g&&f.Ga;g--)a.currentTarget=e[g],d&=zc(f,e[g],a.type,n,a)&&a.kd!=r}if(r in c)if(f=c[r],f.Ga=f.O,b)for(g=0;!a.ec&&g<e.length&&f.Ga;g++)a.currentTarget=e[g],d&=zc(f,e[g],a.type,r,a)&&a.kd!=r;else for(e=this;!a.ec&&e&&
f.Ga;e=e.Yd)a.currentTarget=e,d&=zc(f,e,a.type,r,a)&&a.kd!=r;a=Boolean(d)}else a=n;return a};y.P=function(){Dc.j.P.call(this);wc(this);this.Yd=p};function L(){this.c="base";this.ga=window["X.counter"].nj();this.e=r}H(L,Dc);L.prototype.__defineGetter__("classname",t("c"));L.prototype.__defineGetter__("id",t("ga"));G("X.base",L);function Ec(a,b){this.ya=new ua(a);this.fa=new ua(b)}Ec.prototype={f:function(){return new Ec(this.ya.f(),this.fa.f())},bc:function(){this.fa=this.fa.df()},Th:function(a,b){return new Ec(this.ya.pg(a.ya,b),this.fa.pg(a.fa,b))}};function Fc(a,b){this.fa=a;this.pd=b}Fc.prototype={f:function(){return new Fc(this.fa.f(),this.pd)},bc:function(){this.fa=this.fa.df();this.pd=-this.pd}};function Gc(a,b){this.mb=a;this.de=b;var c=a[0].ya,d=a[2].ya,d=a[1].ya.fd(c).Oe(d.fd(c)).nd();this.xa=new Fc(d,d.vc(c))}
Gc.prototype={f:function(){var a=this.mb.map(function(a){return a.f()});return new Gc(a,this.de)},bc:function(){this.mb.reverse().map(function(a){a.bc()});this.xa.bc()},Kg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.mb.length;h++){var j=a.fa.vc(this.mb[h].ya)-a.pd,j=-1.0E-5>j?2:1.0E-5<j?1:0,f=f|j;g.push(j)}switch(f){case 0:(0<a.fa.vc(this.xa.fa)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.mb.length;h++){var l=(h+1)%this.mb.length,j=
g[h],k=g[l],f=this.mb[h],l=this.mb[l];2!=j&&b.push(f);1!=j&&c.push(2!=j?f.f():f);3==(j|k)&&(j=(a.pd-a.fa.vc(f.ya))/a.fa.vc(l.ya.fd(f.ya)),j=f.Th(l,j),b.push(j),c.push(j.f()))}3<=b.length&&d.push(new Gc(b,this.de));3<=c.length&&e.push(new Gc(c,this.de))}}};function Hc(a){this.ha=this.ia=this.xa=p;this.A=[];a&&this.sc(a)}
Hc.prototype={f:function(){var a=new Hc;a.Vi(this.xa&&this.xa.f());a.Ui(this.ia&&this.ia.f());a.Ti(this.ha&&this.ha.f());a.be(this.A.map(function(a){return a.f()}));return a},ba:function(){for(var a=0;a<this.A.length;a++)this.A[a].bc();this.xa.bc();this.ia&&this.ia.ba();this.ha&&this.ha.ba();a=this.ia;this.ia=this.ha;this.ha=a},Le:function(a){if(!this.xa)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Kg(this.xa,b,c,b,c);this.ia&&(b=this.ia.Le(b));c=this.ha?this.ha.Le(c):[];return b.concat(c)},
Na:function(a){this.A=a.Le(this.A);this.ia&&this.ia.Na(a);this.ha&&this.ha.Na(a)},Eb:function(){var a=this.A.slice();this.ia&&(a=a.concat(this.ia.Eb()));this.ha&&(a=a.concat(this.ha.Eb()));return a},sc:function(a){if(a.length){this.xa||(this.xa=a[0].xa.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Kg(this.xa,this.A,this.A,b,c);b.length&&(this.ia||(this.ia=new Hc),this.ia.sc(b));c.length&&(this.ha||(this.ha=new Hc),this.ha.sc(c))}},Vi:s("xa"),Ui:s("ia"),Ti:s("ha"),be:s("A")};function Lc(){this.A=[]}function Mc(a){var b=new Lc;b.be(a);return b}
Lc.prototype={f:function(){var a=new Lc;a.be(this.A.map(function(a){return a.f()}));return a},uf:function(a){var b=new Hc(this.f().A),a=new Hc(a.f().A);b.Na(a);a.Na(b);a.ba();a.Na(b);a.ba();b.sc(a.Eb());return Mc(b.Eb())},Ta:function(a){var b=new Hc(this.f().A),a=new Hc(a.f().A);b.ba();b.Na(a);a.Na(b);a.ba();a.Na(b);a.ba();b.sc(a.Eb());b.ba();return Mc(b.Eb())},Xe:function(a){var b=new Hc(this.f().A),a=new Hc(a.f().A);b.ba();a.Na(b);a.ba();b.Na(a);a.Na(b);b.sc(a.Eb());b.ba();return Mc(b.Eb())},inverse:function(){var a=
this.f();a.A.map(function(a){a.bc()});return a},be:s("A")};function Nc(){L.call(this);this.c="indexer";this.Fe=[];this.ub={}}H(Nc,L);Nc.prototype.add=function(a){B(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.ub||(this.ub[b]=this.Fe.length,this.Fe.push(a));return this.ub[b]};Nc.prototype.unique=t("Fe");function Oc(a){L.call(this);this.c="file";this.zd=a;this.e=n}H(Oc,L);function Pc(){this.Kb=this.p=p}Pc.prototype.__defineSetter__("file",function(a){this.p=!B(a)||C(a)&&0==a.length?p:C(a)?1==a.length?new Oc(a[0]):yb(a,function(a){var c=new M;c.p=new Oc(a);return c}):new Oc(a)});Pc.prototype.__defineGetter__("file",function(){return!this.p?"":C(this.p)?this.p.map(function(a){return a.p.zd}):this.p.zd});Pc.prototype.__defineGetter__("filedata",t("Kb"));
Pc.prototype.__defineSetter__("filedata",function(a){if(!B(a)||C(a)&&0==a.length)this.Kb=p;if(C(a))if(1==a.length)this.Kb=a[0];else{var b=this.p.length,c;for(c=0;c<b;c++)this.p[c].Kb=a[c]}else this.Kb=a});function Qc(){L.call(this);this.c="colortable";this.ub=new Ob;va(this,new Pc)}H(Qc,L);Qc.prototype.add=function(a,b,c,d,e,f){(!E(a)||!E(c)||!E(d)||!E(e)||!E(f))&&i(Error("Invalid color table entry."));this.ub.set(a,[b,c,d,e,f]);this.e=n};function Rc(a,b,c){this.x=ga(a)?a:0;this.y=ga(b)?b:0;this.b=ga(c)?c:0}Rc.prototype.f=function(){return new Rc(this.x,this.y,this.b)};Rc.prototype.tf=function(){return[this.x,this.y,this.b]};function N(a,b,c){this.x=a;this.y=b;this.b=c}H(N,Rc);y=N.prototype;y.f=function(){return new N(this.x,this.y,this.b)};y.dc=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};y.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};y.ba=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};y.normalize=function(){return this.scale(1/this.dc())};y.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
y.Ta=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};y.Yc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Sc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Tc(a,b){return new N(a.x+b.x,a.y+b.y,a.b+b.b)}function Uc(a,b){return new N(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Vc(a,b){this.x=ga(a)?a:0;this.y=ga(b)?b:0}Vc.prototype.f=function(){return new Vc(this.x,this.y)};function Wc(a,b){return new Vc(a.x-b.x,a.y-b.y)};function Xc(a,b){this.x=a;this.y=b}H(Xc,Vc);y=Xc.prototype;y.f=function(){return new Xc(this.x,this.y)};y.dc=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};y.scale=function(a){this.x*=a;this.y*=a;return this};y.ba=function(){this.x=-this.x;this.y=-this.y;return this};y.normalize=function(){return this.scale(1/this.dc())};y.add=function(a){this.x+=a.x;this.y+=a.y;return this};y.Ta=function(a){this.x-=a.x;this.y-=a.y;return this};
y.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};y.Yc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Yc(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};function Zc(a,b){this.width=a;this.height=b}function $c(a,b){return a==b?n:!a||!b?r:a.width==b.width&&a.height==b.height}Zc.prototype.f=function(){return new Zc(this.width,this.height)};Zc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Zc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Zc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function ad(a,b){if(a instanceof ad)this.X=a.tf();else{var c;if(c=ha(a))a:{for(var d=c=0;d<a.length;d++){if(!ha(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!E(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.X=Db(a):a instanceof Zc?this.X=bd(a.height,a.width):E(a)&&E(b)&&0<a&&0<b?this.X=bd(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.G=new Zc(this.X[0].length,this.X.length)}
function cd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new ad(b)}function dd(a,b,c){for(var d=0;d<a.wa().height;d++)for(var e=0;e<a.wa().width;e++)b.call(c,a.X[d][e],d,e,a)}function ed(a,b){var c=new ad(a.wa());dd(a,function(d,e,f){c.X[e][f]=b.call(m,d,e,f,a)});return c}function bd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}y=ad.prototype;
y.add=function(a){$c(this.G,a.wa())||i(Error("Matrix summation is only supported on arrays of equal size"));return ed(this,function(b,c,d){return b+a.X[c][d]})};y.Yc=function(a,b){if(this.G.width!=a.G.width||this.G.height!=a.G.height)return r;for(var c=b||0,d=0;d<this.G.height;d++)for(var e=0;e<this.G.width;e++)if(!(Math.abs(this.X[d][e]-a.X[d][e])<=(c||1.0E-6)))return r;return n};y.wa=t("G");y.Y=function(a,b){return!(0<=a&&a<this.G.height&&0<=b&&b<this.G.width)?p:this.X[a][b]};
y.k=function(a,b,c){0<=a&&a<this.G.height&&0<=b&&b<this.G.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.G.height+","+this.G.width+")"));this.X[a][b]=c};y.multiply=function(a){if(a instanceof ad)return this.G.width!=a.wa().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),fd(this,a);if(E(a))return gd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
y.Ta=function(a){$c(this.G,a.wa())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return ed(this,function(b,c,d){return b-a.X[c][d]})};y.tf=t("X");function fd(a,b){var c=new ad(a.G.height,b.wa().width);dd(c,function(a,e,f){for(var g=a=0;g<this.G.width;g++)a+=this.Y(e,g)*b.Y(g,f);c.k(e,f,a)},a);return c}function gd(a,b){return ed(a,function(a){return a*b})};function hd(a,b){ad.call(this,a,b);this.c="matrix"}H(hd,ad);function id(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new hd(b)}y=hd.prototype;y.Fa=function(){var a=[],b=this.wa(),c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.Y(c,d));return a};
y.translate=function(a){this.G.width!=this.G.height&&i(Error("Can not translate non-square matrix."));var b=this.wa(),c=cd(b.height);a instanceof Xc&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof N&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):i(Error("Translation failed."));return new hd(this.multiply(c))};
y.rotate=function(a,b){(4!=this.wa().height||this.G.width!=this.G.height)&&i(Error("Only 4x4 matrices can be rotated."));(!B(b)||!(b instanceof N))&&i(Error("Invalid axis vector."));E(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=cd(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,
2,d+c.b*c.b*(1-d));return new hd(this.multiply(f))};y.Ra=function(a){var b=this.wa(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof N&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new ad(c));return new N(parseFloat(a.Y(0,0)),parseFloat(a.Y(1,0)),parseFloat(a.Y(2,0)))};y.hj=function(a,b){var c=this.X[a];this.X[a]=this.X[b];this.X[b]=c};
y.gj=function(a,b){for(var c=this.wa(),d=0,d=0;d<c.height;d++){var e=this.Y(d,a);e||(e=0);var f=this.Y(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};G("X.matrix",hd);G("X.matrix.createIdentityMatrix",id);G("X.matrix.prototype.flatten",hd.prototype.Fa);G("X.matrix.prototype.translate",hd.prototype.translate);G("X.matrix.prototype.rotate",hd.prototype.rotate);G("X.matrix.prototype.toArray",hd.prototype.tf);G("X.matrix.prototype.getValueAt",hd.prototype.Y);G("X.matrix.prototype.setValueAt",hd.prototype.k);
G("X.matrix.prototype.multiplyByVector",hd.prototype.Ra);G("X.matrix.prototype.swapRows",hd.prototype.hj);G("X.matrix.prototype.swapCols",hd.prototype.gj);function kd(){L.call(this);this.c="transform";this.D=id(4);this.Ef=new Float32Array(this.D.Fa())}H(kd,L);kd.prototype.__defineGetter__("matrix",t("D"));kd.prototype.__defineSetter__("matrix",function(a){(!B(a)||!(a instanceof hd))&&i(Error("Invalid matrix."));this.D=a;this.o()});y=kd.prototype;y.Ni=function(a){(!E(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.D=this.D.rotate(a*Math.PI/180,new N(0,1,0));this.o()};
y.Oi=function(a){(!E(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.D=this.D.rotate(a*Math.PI/180,new N(1,0,0));this.o()};y.Pi=function(a){(!E(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.D=this.D.rotate(a*Math.PI/180,new N(0,0,1));this.o()};y.kj=function(a){E(a)||i(Error("Invalid distance."));this.D=this.D.translate(new N(a,0,0));this.o()};y.lj=function(a){E(a)||i(Error("Invalid distance."));this.D=this.D.translate(new N(0,a,0));this.o()};
y.mj=function(a){E(a)||i(Error("Invalid distance."));this.D=this.D.translate(new N(0,0,a));this.o()};function ld(a,b,c){var d=a.D.Y(b,c);d||(d=0);a.D.k(b,c,-1*d);a.o()}y.Bh=function(){ld(this,0,0)};y.Ch=function(){ld(this,1,1)};y.Dh=function(){ld(this,2,2)};y.o=function(){this.Ef=new Float32Array(this.D.Fa());this.e=n};G("X.transform",kd);G("X.transform.prototype.rotateX",kd.prototype.Ni);G("X.transform.prototype.rotateY",kd.prototype.Oi);G("X.transform.prototype.rotateZ",kd.prototype.Pi);
G("X.transform.prototype.translateX",kd.prototype.kj);G("X.transform.prototype.translateY",kd.prototype.lj);G("X.transform.prototype.translateZ",kd.prototype.mj);G("X.transform.prototype.flipX",kd.prototype.Bh);G("X.transform.prototype.flipY",kd.prototype.Ch);G("X.transform.prototype.flipZ",kd.prototype.Dh);G("X.transform.prototype.modified",kd.prototype.o);function md(){L.call(this);this.c="texture";this.la=this.ob=this.p=p;this.Ya=this.Za=0;va(this,new Pc)}H(md,L);md.prototype.__defineSetter__("rawData",s("la"));md.prototype.__defineGetter__("rawData",t("la"));md.prototype.__defineSetter__("rawDataWidth",s("Za"));md.prototype.__defineGetter__("rawDataWidth",t("Za"));md.prototype.__defineSetter__("rawDataHeight",s("Ya"));md.prototype.__defineGetter__("rawDataHeight",t("Ya"));G("X.texture",md);function S(a,b){L.call(this);this.c="triplets";this.Rb=Infinity;this.Ob=-Infinity;this.Sb=Infinity;this.Pb=-Infinity;this.Tb=Infinity;this.Qb=-Infinity;this.qd=[0,0,0];this.B=0;this.M=new Float32Array(a);B(b)&&(this.M=b.M.subarray(0,b.M.length),this.B=this.M.length,this.Rb=b.Rb,this.Ob=b.Ob,this.Sb=b.Sb,this.Pb=b.Pb,this.Tb=b.Tb,this.Qb=b.Qb,this.qd=b.qd.slice())}H(S,L);y=S.prototype;
y.add=function(a,b,c){this.Rb=Math.min(this.Rb,a);this.Ob=Math.max(this.Ob,a);this.Sb=Math.min(this.Sb,b);this.Pb=Math.max(this.Pb,b);this.Tb=Math.min(this.Tb,c);this.Qb=Math.max(this.Qb,c);this.qd=[(this.Rb+this.Ob)/2,(this.Sb+this.Pb)/2,(this.Tb+this.Qb)/2];this.e=n;this.M[this.B++]=a;this.M[this.B++]=b;this.M[this.B++]=c;return this.B/3};y.Cc=function(){if(this.B!=this.M.length){var a=new Float32Array(this.B);a.set(this.M.subarray(0,this.B));this.M=a}};
y.get=function(a){a*=3;return[this.M[a],this.M[a+1],this.M[a+2]]};y.remove=function(){i(Error("Not implemented."))};y.clear=function(){this.M=new Float32Array(this.M.length);this.e=n};S.prototype.__defineGetter__("count",function(){this.Cc();return this.M.length/3});S.prototype.__defineGetter__("length",function(){this.Cc();return this.M.length});G("X.triplets",S);G("X.triplets.prototype.add",S.prototype.add);G("X.triplets.prototype.resize",S.prototype.Cc);G("X.triplets.prototype.get",S.prototype.get);
G("X.triplets.prototype.remove",S.prototype.remove);G("X.triplets.prototype.clear",S.prototype.clear);function nd(){this.ma=rd;this.Zb=new kd;this.Ib=[1,1,1];this.Yb=this.w=this.Z=this.h=this.g=p;this.oc=[];this.La=n;this.nc=this.Rc=1;this.ic=p;this.Kc=r;this.aa=1;this.L=0}var rd="TRIANGLES";nd.prototype.__defineSetter__("type",function(a){return this.ma=a});nd.prototype.__defineGetter__("type",t("ma"));nd.prototype.__defineGetter__("texture",function(){this.w||(this.w=new md);return this.w});nd.prototype.__defineGetter__("transform",t("Zb"));nd.prototype.__defineGetter__("points",t("g"));
nd.prototype.__defineSetter__("points",s("g"));nd.prototype.__defineGetter__("normals",t("h"));nd.prototype.__defineSetter__("normals",s("h"));nd.prototype.__defineGetter__("colors",t("Z"));nd.prototype.__defineSetter__("colors",s("Z"));nd.prototype.__defineGetter__("color",t("Ib"));nd.prototype.__defineSetter__("color",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Ib=a;this.e=n});
nd.prototype.__defineGetter__("opacity",t("aa"));nd.prototype.__defineSetter__("opacity",function(a){(!E(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.aa=a;this.e=n});nd.prototype.__defineGetter__("caption",t("ic"));nd.prototype.__defineSetter__("caption",function(a){this.ic=a;this.e=n});nd.prototype.__defineGetter__("visible",t("La"));
nd.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.La=a;this.e=n});nd.prototype.__defineGetter__("pointsize",t("Rc"));nd.prototype.__defineSetter__("pointsize",function(a){E(a)||i(Error("Invalid point size."));this.Rc=a;this.e=n});nd.prototype.__defineGetter__("magicmode",t("Kc"));nd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Kc=a;this.e=n});
nd.prototype.__defineGetter__("linewidth",t("nc"));nd.prototype.__defineSetter__("linewidth",function(a){E(a)||i(Error("Invalid line width."));this.nc=a;this.e=n});function sd(){this.Ka=Infinity;this.R=this.Da=-Infinity;this.U=Infinity;this.xb=[0,0,0];this.vb=[1,1,1]}sd.prototype.__defineGetter__("lowerThreshold",t("R"));sd.prototype.__defineSetter__("lowerThreshold",s("R"));sd.prototype.__defineGetter__("upperThreshold",t("U"));sd.prototype.__defineSetter__("upperThreshold",s("U"));sd.prototype.__defineGetter__("min",t("Ka"));sd.prototype.__defineGetter__("max",t("Da"));sd.prototype.__defineGetter__("minColor",t("xb"));
sd.prototype.__defineSetter__("minColor",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid min. color."));this.xb=a});sd.prototype.__defineGetter__("maxColor",t("vb"));sd.prototype.__defineSetter__("maxColor",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid max. color."));this.vb=a});function td(){L.call(this);this.c="scalars";this.Fc=this.r=p;this.Pf=n;this.me=0;va(this,new Pc);va(this,new sd);this.xb=[0,1,0];this.vb=[1,0,0]}H(td,L);td.prototype.__defineGetter__("array",t("r"));td.prototype.__defineSetter__("array",function(a){this.Fc=this.r=a;this.e=n});td.prototype.__defineGetter__("interpolation",t("me"));td.prototype.__defineSetter__("interpolation",s("me"));G("X.scalars",td);function V(a){L.call(this);this.c="object";this.d=[];this.u=this.ca=p;va(this,new nd);B(a)&&this.$b(a)}H(V,L);
V.prototype.$b=function(a){this.ma=a.ma;this.Zb=new kd;this.Zb.D=new hd(a.Zb.D.X);this.Ib=a.Ib.slice();a.g&&(this.g=new S(a.g.length,a.g));a.h&&(this.h=new S(a.h.length,a.h));a.Z&&(this.Z=new S(a.Z.length,a.Z));this.w=a.w;this.Yb=a.Yb;a.p&&(this.p=new Oc((new String(a.p.zd)).toString()));this.aa=a.aa;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new I[b[d].c](b[d]));this.La=a.La;this.Rc=a.Rc;this.nc=a.nc;a.ic&&(this.ic=(new String(a.ic)).toString());this.Kc=a.Kc;this.oc=
a.oc.slice();this.e=n};V.prototype.__defineGetter__("colortable",function(){this.ca||(this.ca=new Qc);return this.ca});V.prototype.__defineGetter__("scalars",function(){this.u||(this.u=new td);return this.u});V.prototype.__defineGetter__("children",t("d"));V.prototype.o=function(){var a=new ud;a.ea=this;this.dispatchEvent(a)};
function vd(a,b){(!B(a)||!B(b)||!(a instanceof V)||!(b instanceof V))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.aa?-1:1==b.aa?1:B(a.L)&&B(b.L)&&a.L>b.L?-1:1}G("X.object",V);G("X.object.prototype.modified",V.prototype.o);function wd(){}function xd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),j=a.h.get(d+1),l=a.h.get(d+2),k=a.Ib;a.Z&&0<a.Z.length&&(k=a.Z.get(d));var o=[];o.push(new Ec(e,h));o.push(new Ec(f,j));o.push(new Ec(g,l));c.push(new Gc(o,k))}return Mc(c)}
function yd(a,b){(!B(b)||!(b instanceof Lc))&&i(Error("Invalid CSG object."));var c=new Nc,d=[];yb(b.A,function(a){for(var b=[],g=a.de,b=yb(a.mb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.bh=yb(c.unique(),function(a){return[a.ya.x(),a.ya.y(),a.ya.b()]});a.ah=yb(c.unique(),function(a){return[a.fa.x(),a.fa.y(),a.fa.b()]});a.$g=yb(c.unique(),function(a){return!a.color?p:[a.color[0],a.color[1],a.color[2]]});a.g=new S(9*d.length);a.h=new S(9*d.length);
a.Z=new S(9*d.length);yb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.bh,j=this.ah,l=this.$g;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(j[b][0],j[b][1],j[b][2]);this.h.add(j[c][0],j[c][1],j[c][2]);this.h.add(j[a][0],j[a][1],j[a][2]);l[b]&&this.Z.add(l[b][0],l[b][1],l[b][2]);l[c]&&this.Z.add(l[c][0],l[c][1],l[c][2]);l[a]&&this.Z.add(l[a][0],l[a][1],l[a][2])}.bind(a));0==a.Z.B&&(a.Z=p);a.ma=rd}
wd.prototype.uf=function(a){(!B(a)||!(a instanceof Lc)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=xd(b));a=new V;va(a,new wd);yd(a,xd(this).uf(b));return a};wd.prototype.Ta=function(a){(!B(a)||!(a instanceof Lc)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=xd(b));a=new V;va(a,new wd);yd(a,xd(this).Ta(b));return a};
wd.prototype.Xe=function(a){(!B(a)||!(a instanceof Lc)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=xd(b));a=new V;va(a,new wd);yd(a,xd(this).Xe(b));return a};wd.prototype.inverse=function(){var a=new V;va(a,new wd);yd(a,xd(this).inverse());return a};G("X.constructable",wd);G("X.constructable.prototype.intersect",wd.prototype.Xe);G("X.constructable.prototype.inverse",wd.prototype.inverse);G("X.constructable.prototype.subtract",wd.prototype.Ta);
G("X.constructable.prototype.union",wd.prototype.uf);function zd(a){jc.call(this,a);this.c="event"}H(zd,jc);var Ad=Cc("pan"),Bd=Cc("rotate"),Cd=Cc("zoom"),Dd=Cc("scroll");Cc("render");var Ed=Cc("resetview"),Fd=Cc("windowlevel"),yc=Cc("modified"),Gd=Cc("progress"),Hd=Cc("hover"),Id=Cc("hover_end");function Kd(){zd.call(this,Fd);this.se=this.Ge=0}H(Kd,zd);function Ld(){zd.call(this,Ad);this.L=new Xc(0,0)}H(Ld,zd);function Md(){zd.call(this,Bd);this.L=new Xc(0,0)}H(Md,zd);function Nd(){zd.call(this,Cd);this.Ja=this.Wa=r}H(Nd,zd);
function Od(){zd.call(this,Dd);this.J=r}H(Od,zd);function Pd(){zd.call(this,Hd);this.Gd=this.Fd=0}H(Pd,zd);function Qd(){zd.call(this,Id)}H(Qd,zd);function Rd(){zd.call(this,Ed)}H(Rd,zd);function ud(){zd.call(this,yc);this.t=this.ea=p}H(ud,zd);function Sd(){zd.call(this,Gd);this.Rf=0}H(Sd,zd);function Td(){L.call(this);this.c="parser";this.da=p;this.B=0;this.fh=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.ud=n}H(Td,L);Td.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Ud(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}function Vd(a,b,c){b===m&&(b=0);c===m&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d}
function W(a,b,c){B(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.da.slice(a.B,a.B+=c*d));if(a.fh!=a.ud){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Wd(a,b,c){I.Ia(a.c+".reslice");var d=b.$,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],j=b.n!=p,l=h*d,k=Array(g),o=Array(g),v=0,q=p;b.ca&&(q=b.ca.ub);for(var w=0,u=0,z=0,D=0,x=4*l,w=0;w<g;w++){k[w]=Array(h);o[w]=Array(h);for(var A=f.subarray(w*l,(w+1)*l),F=new Uint8Array(x),u=D=0;u<h;u++){k[w][u]=new c.data.constructor(d);o[w][u]=new c.data.constructor(d);for(z=0;z<d;z++){var v=A[D],J=0,T=0,O=0,P=0;q?(P=q.get(Math.floor(v)),P||(J=q.Pa(),P=J[J.length-1]),J=255*P[1],T=255*P[2],O=255*P[3],P=255*P[4]):
(J=T=O=255*(v/e),P=255);var fa=4*D;F[fa]=J;F[++fa]=T;F[++fa]=O;F[++fa]=P;k[w][u][z]=255*(v/e);o[w][u][z]=v;D++}}v=new md;v.la=F;v.Za=d;v.Ya=h;A=b.ib.d[w];A.w=v;j&&(A.n=b.n.ib.d[w].w)}b.ze&&(d!=h?j?b.ca?(Xd(g,d,h,o,b.ca,b.T,b.n.T,n),Xd(g,h,d,o,b.ca,b.S,b.n.S,r)):(Yd(g,d,h,k,b.T,b.n.T,n),Yd(g,h,d,k,b.S,b.n.S,r)):b.ca?(Xd(g,d,h,o,b.ca,b.T,p,n),Xd(g,h,d,o,b.ca,b.S,p,r)):(Yd(g,d,h,k,b.T,p,n),Yd(g,h,d,k,b.S,p,r)):j?b.ca?Zd(g,d,h,k,b.ca,b.S,b.n.S,b.T,b.n.T):$d(g,d,h,k,b.S,b.n.S,b.T,b.n.T):b.ca?Zd(g,d,h,
o,b.ca,b.S,p,b.T,p):$d(g,d,h,k,b.S,p,b.T,p));I.Ca(a.c+".reslice");return o}function Yd(a,b,c,d,e,f,g){for(var h=4*a*b,j=0,j=0;j<c;j++){for(var l=new Uint8Array(h),k=0,o=0,k=0;k<a;k++)for(var v=0,q=d[k],v=0;v<b;v++){var w,u=w=g?q[j][v]:q[v][j],z=w,D=4*o;l[D]=w;l[++D]=u;l[++D]=z;l[++D]=255;o++}k=new md;k.la=l;k.Za=b;k.Ya=a;l=e.d[j];l.w=k;f&&(l.n=f.d[j].w)}}
function Xd(a,b,c,d,e,f,g,h){for(var e=e.ub,j=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(j),o=0,v=0,o=0;o<a;o++)for(var q=d[o],w=0,w=0;w<b;w++){var u=e.get(Math.floor(h?q[l][w]:q[w][l]));u||(u=e.Pa(),u=u[u.length-1]);var z=255*u[2],D=255*u[3],x=255*u[4],A=4*v;k[A]=255*u[1];k[++A]=z;k[++A]=D;k[++A]=x;v++}o=new md;o.la=k;o.Za=b;o.Ya=a;k=f.d[l];k.w=o;g&&(k.n=g.d[l].w)}}
function $d(a,b,c,d,e,f,g,h){for(var j=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(j),o=new Uint8Array(j),v=0,q=0,q=0;q<a;q++)for(var w=d[q],u=0,u=0;u<b;u++){var z=w[u][l],D=z,x=z,A=4*v;k[A]=z;k[++A]=D;k[++A]=x;k[++A]=255;x=D=z=A=w[l][u];A=4*v;o[A]=z;o[++A]=D;o[++A]=x;o[++A]=255;v++}v=new md;v.la=k;v.Za=b;v.Ya=a;k=e.d[l];k.w=v;f&&(k.n=f.d[l].w);k=new md;k.la=o;k.Za=b;k.Ya=a;o=g.d[l];o.w=k;h&&(o.n=h.d[l].w)}}
function Zd(a,b,c,d,e,f,g,h,j){for(var e=e.ub,l=4*a*b,k=0,k=0;k<c;k++){for(var o=new Uint8Array(l),v=new Uint8Array(l),q=0,w=0,w=0;w<a;w++)for(var u=d[w],z=0,z=0;z<b;z++){var D=e.get(Math.floor(u[z][k]));if(!D)var x=e.Pa(),D=x[x.length-1];var A=255*D[2],F=255*D[3],J=255*D[4],x=4*q;o[x]=255*D[1];o[++x]=A;o[++x]=F;o[++x]=J;x=e.get(Math.floor(u[k][z]));x||(x=e.Pa(),x=x[x.length-1]);D=255*x[1];A=255*x[2];F=255*x[3];J=255*x[4];x=4*q;v[x]=D;v[++x]=A;v[++x]=F;v[++x]=J;q++}q=new md;q.la=o;q.Za=b;q.Ya=a;o=
f.d[k];o.w=q;g&&(o.n=g.d[k].w);o=new md;o.la=v;o.Za=b;o.Ya=a;v=h.d[k];v.w=o;j&&(v.n=j.d[k].w)}};function ae(){Td.call(this);this.c="parserLBL"}H(ae,Td);
ae.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");var d=b.oc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.da=c;for(var f=[],g=W(this,"uchar",c.byteLength),h=g.length,j=r,l=0,c=1;c<h;c++)10==g[c-1]?(l=c,j=n):j&&32==g[c]&&(f.push(parseInt(Vd(g,l,c),10)),j=r);g=b.u.r?b.u.r:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)j=d[c],j>e&&i(Error("Could not find scalar for vertex.")),j=g[j],f[h++]=j,f[h++]=j,f[h++]=j;b.u.r=
g;b.u.Fc=f;b.u.e=n;I.Ca(this.c+".parse");d=new ud;d.ea=b;d.t=a;this.dispatchEvent(d)};G("X.parserLBL",ae);G("X.parserLBL.prototype.parse",ae.prototype.parse);function be(a){this.q=a;this.qg=K(this.q,Va?"DOMMouseScroll":"mousewheel",this)}H(be,Dc);
be.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ea;if("mousewheel"==a.type){c=1;if(Ua||Wa&&(Ma||lb("532.0")))c=40;d=Wa&&La&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ga(a.wheelDeltaX)?(b=Wa&&La&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Wa&&La&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ga(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;E(this.sg)&&Math.min(Math.max(b,-this.sg),this.sg);E(this.tg)&&(c=Math.min(Math.max(c,
-this.tg),this.tg));b=new ce(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Oa()}};be.prototype.P=function(){be.j.P.call(this);uc(this.qg);delete this.qg};function ce(a,b,c,d){b&&this.ja(b,m);this.type="mousewheel";this.detail=a;this.uc=d}H(ce,lc);Ua||Wa&&lb("525");var de;function ee(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Eb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=wb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var fe=!Ua||nb(9);!Va&&!Ua||Ua&&nb(9)||Va&&lb("1.9.1");Ua&&lb("9");function ge(a){return a?new he(ie(a)):de||(de=new he)}function je(a){return ia(a)?document.getElementById(a):a}function ke(a,b){ob(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in le?a.setAttribute(le[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var le={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function me(a,b,c){return ne(document,arguments)}
function ne(a,b){var c=b[0],d=b[1];if(!fe&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',ya(d.name),'"');if(d.type){c.push(' type="',ya(d.type),'"');var e={};sb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ia(d)?c.className=d:C(d)?ee.apply(p,[c].concat(d)):ke(c,d));2<b.length&&oe(a,c,b);return c}
function oe(a,b,c){function d(c){c&&b.appendChild(ia(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ha(f)&&!(ka(f)&&0<f.nodeType)?xb(pe(f)?Db(f):f,d):d(f)}}function te(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ue(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function ve(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function ie(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function pe(a){if(a&&"number"==typeof a.length){if(ka(a))return"function"==typeof a.item||"string"==typeof a.item;if(ja(a))return"function"==typeof a.item}return r}function he(a){this.Q=a||ca.document||document}y=he.prototype;
y.Od=ge;y.i=function(a){return ia(a)?this.Q.getElementById(a):a};y.Vg=he.prototype.i;y.tc=function(a,b,c){return ne(this.Q,arguments)};y.createElement=function(a){return this.Q.createElement(a)};y.createTextNode=function(a){return this.Q.createTextNode(a)};function we(a){return"CSS1Compat"==a.Q.compatMode}function xe(a){var b=a.Q,a=!Wa&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Vc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}
y.appendChild=function(a,b){a.appendChild(b)};y.contains=ve;function Y(a){(!B(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));L.call(this);this.c="interactor";this.sa=a;this.ue=this.If=this.Hf=this.Jf=this.Gf=this.Kf=p;this.te=n;this.Bb=this.wb=this.hb=r;this.xd=[0,0];this.oe=new Xc(0,0);this.Jc=new Xc(0,0);this.ng=0;this.Qf=this.td=p;this.K={MOUSEWHEEL_ENABLED:n,MOUSECLICKS_ENABLED:n,KEYBOARD_ENABLED:n,HOVERING_ENABLED:n,CONTEXTMENU_ENABLED:r,TOUCH_ENABLED:n,TOUCH_BOUNCING_ENABLED:r}}H(Y,L);
Y.prototype.__defineGetter__("config",t("K"));Y.prototype.__defineGetter__("leftButtonDown",t("hb"));Y.prototype.__defineGetter__("middleButtonDown",t("wb"));Y.prototype.__defineGetter__("rightButtonDown",t("Bb"));
Y.prototype.ja=function(){this.K.MOUSEWHEEL_ENABLED?(this.ue=new be(this.sa),this.Kf=K(this.ue,"mousewheel",this.gd.bind(this))):(uc(this.Kf),this.ue=p);this.K.MOUSECLICKS_ENABLED?(this.Gf=K(this.sa,"mousedown",this.ei.bind(this)),this.Jf=K(this.sa,"mouseup",this.ji.bind(this))):(uc(this.Gf),uc(this.Jf));this.sa.oncontextmenu=this.K.CONTEXTMENU_ENABLED?p:function(){return r};window.onkeydown=this.K.KEYBOARD_ENABLED?this.yg.bind(this):p;this.K.TOUCH_ENABLED?(this.K.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},r),this.jh=K(this.sa,"touchstart",this.xi.bind(this)),this.ih=K(this.sa,"touchmove",this.vi.bind(this)),this.hh=K(this.sa,"touchend",this.ri.bind(this))):(uc(this.jh),uc(this.ih),uc(this.hh));uc(this.Hf);uc(this.If);this.Hf=K(this.sa,"mousemove",this.gi.bind(this));this.If=K(this.sa,"mouseout",this.hi.bind(this))};
Y.prototype.ei=function(a){0==a.button?this.hb=n:1==a.button?this.wb=n:2==a.button&&(this.Bb=n);eval("this.onMouseDown("+this.hb+","+this.wb+","+this.Bb+")");ye(this);a.preventDefault()};Y.prototype.di=ba();Y.prototype.ji=function(a){0==a.button?this.hb=r:1==a.button?this.wb=r:2==a.button&&(this.Bb=r);eval("this.onMouseUp("+this.hb+","+this.wb+","+this.Bb+")");ye(this);a.preventDefault()};Y.prototype.__defineGetter__("mousePosition",t("xd"));y=Y.prototype;y.ii=ba();
y.hi=function(a){this.te=r;this.K.KEYBOARD_ENABLED&&(window.onkeydown=p);this.Bb=this.wb=this.hb=r;ye(this);this.oe=new Xc(0,0);a.preventDefault()};y.fi=ba();y.xi=function(a){a.preventDefault();a.ja(a.Ea.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Jc=new Xc(a.clientX,a.clientY);this.Qf=setTimeout(this.ti.bind(this,a),500)};y.wi=ba();
y.ti=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Nd;a.Wa=n;a.Ja=this instanceof ze;this.dispatchEvent(a);this.Cd=n};y.si=ba();function Ae(a){clearTimeout(a.Qf);if(a.Cd){var b=new Nd;b.Wa=r;b.Ja=a instanceof ze;a.dispatchEvent(b)}a.Cd=r}y.ri=function(a){a.preventDefault();eval("this.onTouchEnd()");Ae(this)};y.qi=ba();
y.vi=function(a){a.preventDefault();this.Cd||Ae(this);this.touchmoveEvent=a=a.Ea;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){var a=b[0],c=[a.clientX,a.clientY],a=new Xc(c[0],c[1]),b=c[0]>3*this.sa.clientWidth/4,d=c[0]<this.sa.clientWidth/4,e=c[1]<this.sa.clientHeight/4,c=c[1]>3*this.sa.clientHeight/4,c=!b&&!d&&!e&&!c,e=this.Jc.Ta(a);this.Jc=a.f();if(this.Cd)a=new Ld,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a.L=e,this.dispatchEvent(a);else if(this instanceof
Be&&(b||d))a=new Od,a.J=0>e.y,this.dispatchEvent(a);else if(this instanceof ze||c)e.scale(3),a=new Md,a.L=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new Xc(a[0],a[1]),e=Yc(a,new Xc(b[0],b[1])),b=e-this.ng,this.ng=e,this.Jc.Ta(a),this.Jc=a.f(),10<Math.abs(b)&&(a=new Nd,a.Wa=0<b,a.Ja=this instanceof ze,this.dispatchEvent(a)))};y.ui=ba();
y.gi=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.te=n;this.K.KEYBOARD_ENABLED&&window.onkeydown==p&&(window.onkeydown=this.yg.bind(this));a.preventDefault();var b=a.shiftKey;this.xd=[a.offsetX,a.offsetY];var c=new Xc(this.xd[0],this.xd[1]),a=this.oe.Ta(c);this.oe=c.f();this.K.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.wb||this.hb||this.Bb)&&ye(this),this.td=setTimeout(function(){ye(this);var a=new Pd;a.Fd=c.x;a.Gd=c.y;this.dispatchEvent(a);
this.td=p}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.dc()&&(this.hb&&!b?(b=new Md,a.scale(3),b.L=a,this.dispatchEvent(b)):this.wb||this.hb&&b?(b=new Ld,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.L=a,this.dispatchEvent(b)):this.Bb&&(b=new Nd,b.Wa=0<a.y,b.Ja=r,this.dispatchEvent(b)))};function ye(a){a.td&&clearTimeout(a.td);a.dispatchEvent(new Qd)}y.ki=ba();
y.gd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");ye(this);a.preventDefault()};y.bi=ba();
y.yg=function(a){if(this.te){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");ye(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Rd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Ld:b?a=new Nd:(a=new Md,this instanceof Be&&(a=new Od)),a&&(c=new Xc(0,0),37==f?(c.x=5,a.J=r,b&&(a.J=n,a.Wa=n,a.Ja=r)):39==f?(c.x=-5,a.J=n,b&&(a.Wa=r,a.Ja=r)):38==f?(c.y=5,a.J=n,b&&(a.Wa=n,a.Ja=n)):40==f&&(c.y=-5,a.J=r,b&&(a.Wa=r,
a.Ja=n)),a.L=c,this.dispatchEvent(a)))}};G("X.interactor",Y);G("X.interactor.prototype.init",Y.prototype.ja);G("X.interactor.prototype.onMouseDown",Y.prototype.di);G("X.interactor.prototype.onMouseUp",Y.prototype.ii);G("X.interactor.prototype.onMouseMove",Y.prototype.fi);G("X.interactor.prototype.onMouseWheel",Y.prototype.ki);G("X.interactor.prototype.onKey",Y.prototype.bi);G("X.interactor.prototype.onTouchStart",Y.prototype.wi);G("X.interactor.prototype.onTouchMove",Y.prototype.ui);
G("X.interactor.prototype.onTouchEnd",Y.prototype.qi);G("X.interactor.prototype.onTouchHover",Y.prototype.si);function Be(a){Y.call(this,a);this.c="interactor2D"}H(Be,Y);Be.prototype.gd=function(a){Be.j.gd.call(this,a);var b=new Od;B(a.uc)||(a.uc=0);b.J=0>a.uc;this.dispatchEvent(b)};function Ce(a){V.call(this);this.c="slice";this.l=[0,0,0];this.lc=[0,0,1];this.J=[0,1,0];this.H=this.N=10;this.Yb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.Bd=this.kb=p;this.Va=n;this.hc=[1,1,1];B(a)&&this.$b(a)}H(Ce,V);Ce.prototype.$b=function(a){this.l=a.l.slice();this.lc=a.lc.slice();this.J=a.J.slice();this.N=a.N;this.H=a.H;this.kb=a.kb;this.n=a.n;this.Va=a.Va;this.hc=a.hc;this.eh=a.eh;Ce.j.$b.call(this,a)};
Ce.prototype.Ig=function(a,b,c,d,e,f,g){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid center."));(!B(b)||!C(b)||3!=b.length)&&i(Error("Invalid front direction."));(!B(c)||!C(c)||3!=c.length)&&i(Error("Invalid up direction."));E(d)||i(Error("Invalid width."));E(e)||i(Error("Invalid height."));var h=r;B(f)&&(h=f);f=[1,1,1];B(g)&&(f=g);this.l=a;this.lc=b;this.J=c;this.N=d;this.H=e;this.Va=h;this.hc=f;De(this)};
function De(a){var b=new N(a.lc[0],a.lc[1],a.lc[2]),c=new N(a.J[0],a.J[1],a.J[2]),d=Uc(c,b),e=new N(a.l[0],a.l[1],a.l[2]),f=new N(1,1,1);1==b.x?(f=new N(a.l[0],a.H/2,a.N/2),a.Yb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==b.y?(f=new N(a.N/2,a.l[1],a.H/2),a.Yb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==b.b&&(f=new N(a.N/2,a.H/2,a.l[2]));var g=Tc(d.f().ba(),c.f().ba()),g=new N(g.x*f.x,g.y*f.y,g.b*f.b);g.add(e);var h=Tc(d.f().ba(),c),h=new N(h.x*f.x,h.y*f.y,h.b*f.b);h.add(e);var j=Tc(d,c.f().ba()),j=new N(j.x*f.x,j.y*f.y,j.b*
f.b);j.add(e);var l=j,c=Tc(d,c),c=new N(c.x*f.x,c.y*f.y,c.b*f.b);c.add(e);e=h;a.g=new S(18);a.h=new S(18);a.g.add(g.x,g.y,g.b);a.g.add(h.x,h.y,h.b);a.g.add(j.x,j.y,j.b);a.g.add(l.x,l.y,l.b);a.g.add(c.x,c.y,c.b);a.g.add(e.x,e.y,e.b);a.h.add(b.x,b.y,b.b);a.h.add(b.x,b.y,b.b);a.h.add(b.x,b.y,b.b);a.h.add(b.x,b.y,b.b);a.h.add(b.x,b.y,b.b);a.h.add(b.x,b.y,b.b);a.Va&&(b=new V,b.g=new S(24),b.h=new S(24),b.g.add(g.x,g.y,g.b),b.g.add(h.x,h.y,h.b),b.g.add(h.x,h.y,h.b),b.g.add(c.x,c.y,c.b),b.g.add(c.x,c.y,
c.b),b.g.add(j.x,j.y,j.b),b.g.add(j.x,j.y,j.b),b.g.add(g.x,g.y,g.b),b.h.add(0,0,0),b.h.add(0,0,0),b.h.add(0,0,0),b.h.add(0,0,0),b.h.add(0,0,0),b.h.add(0,0,0),b.h.add(0,0,0),b.h.add(0,0,0),b.Ib=[a.hc[0],a.hc[1],a.hc[2]],b.ma="LINES",b.nc=2,a.d.push(b))}Ce.prototype.__defineSetter__("stack",s("Bd"));Ce.prototype.__defineGetter__("stack",t("Bd"));G("X.slice",Ce);G("X.slice.prototype.setup",Ce.prototype.Ig);function M(a){V.call(this);this.c="volume";this.l=[0,0,0];this.$=[10,10,10];this.I=[1,1,1];this.ob=[];this.Ic=this.rb=this.Hc=this.qb=this.Gc=this.pb=0;this.S=new V;this.T=new V;this.ib=new V;this.Ed=this.Ma=r;this.Db=0;this.n=p;this.Va=n;this.W=Infinity;this.V=-Infinity;this.ze=n;va(this,new Pc);va(this,new sd);B(a)&&this.$b(a)}H(M,V);
M.prototype.$b=function(a){window.console.log(a);this.l=a.l.slice();this.$=a.$.slice();this.I=a.I.slice();this.pb=a.pb;this.Gc=a.Gc;this.qb=a.qb;this.Hc=a.Hc;this.rb=a.rb;this.Ic=a.Ic;this.S=new V(a.S);this.T=new V(a.T);this.ib=new V(a.ib);this.Ma=a.Ma;this.Ed=a.Ed;this.Db=a.Db;this.n=a.n;this.Va=a.Va;M.j.$b.call(this,a)};
M.prototype.create=function(){this.d.length=0;this.S.d.length=0;this.T.d.length=0;this.ib.d.length=0;this.d.push(this.S);this.d.push(this.T);this.d.push(this.ib);for(var a=0,a=0;3>a;a++){for(var b=(this.$[a]-1)/2,c=b,d=0,d=0;d<this.$[a];d++){var e=-b*this.I[a]+d*this.I[a],e=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],f=this.d[a].d,g=0,h=0,j=[1,1,1],l=this.Va;0==a?(g=this.$[2]*this.I[2]-this.I[2],h=this.$[1]*this.I[1]-this.I[1],j=[1,1,0]):
1==a?(g=this.$[0]*this.I[0]-this.I[0],h=this.$[2]*this.I[2]-this.I[2],j=[1,0,0]):2==a&&(g=this.$[0]*this.I[0]-this.I[0],h=this.$[1]*this.I[1]-this.I[1],j=[0,1,0]);B(this.kb)&&(l=r);var k=new Ce;k.Ig(e[a],[[1,0,0],[0,1,0],[0,0,1]][a],[[0,1,0],[0,0,-1],[0,1,0]][a],g,h,l,j);k.kb=this;k.visible=d==Math.floor(c);f.push(k)}0==a?this.Gc=this.pb=c:1==a?this.Hc=this.qb=c:2==a&&(this.Ic=this.rb=c)}this.e=n};
M.prototype.o=function(a){a="undefined"!==typeof a?a:n;if(0<this.d.length)if(this.Ma!=this.Ed&&(this.Ma?(this.d[0].d[parseInt(this.pb,10)].visible=r,this.d[1].d[parseInt(this.qb,10)].visible=r,this.d[2].d[parseInt(this.rb,10)].visible=r):this.d[this.Db].visible=r,this.e=n,this.Ed=this.Ma),this.Ma)Ee(this,this.Db);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.pb,e=this.Gc,this.Gc=this.pb):1==b?(d=this.qb,e=this.Hc,this.Hc=this.qb):2==b&&(d=this.rb,e=this.Ic,this.Ic=this.rb);c.d[parseInt(e,
10)].visible=r;c=c.d[parseInt(d,10)];c.visible=n;c.aa=1}a&&M.j.o.call(this)};M.prototype.__defineGetter__("dimensions",t("$"));M.prototype.__defineSetter__("dimensions",s("$"));M.prototype.__defineGetter__("volumeRendering",t("Ma"));M.prototype.__defineSetter__("volumeRendering",function(a){this.Ma=a;this.o(r)});M.prototype.__defineSetter__("visible",s("La"));M.prototype.__defineGetter__("center",t("l"));
M.prototype.__defineSetter__("center",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid center."));this.l=a});M.prototype.__defineGetter__("image",t("ob"));M.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new Fe(this));return this.n});M.prototype.__defineGetter__("indexX",t("pb"));M.prototype.__defineSetter__("indexX",function(a){E(a)&&0<=a&&a<this.S.d.length&&(this.pb=a,this.o(r))});M.prototype.__defineGetter__("indexY",t("qb"));
M.prototype.__defineSetter__("indexY",function(a){E(a)&&0<=a&&a<this.T.d.length&&(this.qb=a,this.o(r))});M.prototype.__defineGetter__("indexZ",t("rb"));M.prototype.__defineSetter__("indexZ",function(a){E(a)&&0<=a&&a<this.ib.d.length&&(this.rb=a,this.o(r))});M.prototype.__defineGetter__("windowLow",t("W"));M.prototype.__defineSetter__("windowLow",s("W"));M.prototype.__defineGetter__("windowHigh",t("V"));M.prototype.__defineSetter__("windowHigh",s("V"));M.prototype.__defineGetter__("borders",t("Va"));
M.prototype.__defineSetter__("borders",s("Va"));M.prototype.__defineGetter__("reslicing",t("ze"));M.prototype.__defineSetter__("reslicing",s("ze"));function Ee(a,b){if(a.Ma&&(a.e||b!=a.Db)){var c=a.d[a.Db];c.visible=r;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].La=n;a.Db=b;a.e=r}}G("X.volume",M);G("X.volume.prototype.modified",M.prototype.o);G("X.volume.prototype.create",M.prototype.create);function Ge(){Td.call(this);this.c="parserSTL"}H(Ge,Td);
Ge.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");this.da=c;var d=b.g,e=b.h;if("solid"==Vd(W(this,"uchar",5))){b.g=d=new S(c.byteLength);b.h=e=new S(c.byteLength);var f=d,d=e,e=W(this,"uchar",c.byteLength-5),c=e.length,g=r,h=r,j=0,l;for(l=0;l<c;l++)if(10==e[l]){if(g||h){var k=Vd(e,j,l).split(" "),h=parseFloat(k[0]),o=parseFloat(k[1]),k=parseFloat(k[2]);g?(d.add(h,o,k),d.add(h,o,k),d.add(h,o,k)):f.add(h,o,k);h=g=r}}else 32==e[l-1]&&(102==e[l]?(j=l+=13,g=n):118==e[l]&&(j=l+=7,h=n))}else{this.B=
80;f=W(this,"uint");b.g=d=new S(9*f);b.h=e=new S(9*f);for(c=c=0;c<f;c++)g=W(this,"float",12),j=g[0],l=g[1],h=g[2],e.add(j,l,h),e.add(j,l,h),e.add(j,l,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.B+=2}I.Ca(this.c+".parse");f=new ud;f.ea=b;f.t=a;this.dispatchEvent(f)};G("X.parserSTL",Ge);G("X.parserSTL.prototype.parse",Ge.prototype.parse);function He(a){function b(){Ic+=8;return Na<qa.length?qa[Na++]:-1}function c(){var a;Ic++;a=U&1;U>>=1;0==U&&(U=b(),a=U&1,U=U>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=T[b]>>8-a);return b}function e(a){x[A++]=a;if(J==w-1){var b=new Uint8Array(2*w);b.set(q);q=b;w*=2}q[J++]=a;32768==A&&(A=0)}function f(){this.Id=this.Hd=0;this.Ye=p}function g(){for(;;){if(ub[Ga]>=od)return-1;if(Jc[ub[Ga]]==Ga)return ub[Ga]++;ub[Ga]++}}function h(){var a=Kc[Lb],b;if(17==Ga)return-1;Lb++;Ga++;
b=g();if(0<=b)a.Hd=b;else if(a.Hd=32768,h())return-1;b=g();if(0<=b)a.Id=b,a.Ye=p;else if(a.Id=32768,a.Ye=Kc[Lb],a.fk=Lb,h())return-1;Ga--;return 0}function j(a,b,c){Kc=a;Lb=0;Jc=c;od=b;for(a=0;17>a;a++)ub[a]=0;Ga=0;return h()?-1:0}function l(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Id&32768))return f.Id;f=f.Ye;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Hd&32768))return f.Hd;e++;f=a[e]}}function k(){var a,g,h,k,o;do if(a=c(),h=d(2),0==h){U=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=T[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var q;h-=257;o=d(P[h])+O[h];h=T[d(5)]>>3;8<R[h]?(q=d(8),q|=d(R[h]-8)<<8):q=d(R[h]);q+=fa[h];for(h=0;h<o;h++)g=x[A-q&32767],e(g)}else if(2==h){var u=Array(320);g=257+d(5);q=1+d(5);k=4+d(4);for(h=0;19>h;h++)u[h]=0;for(h=0;h<k;h++)u[aa[h]]=d(3);o=kb.length;for(k=0;k<o;k++)kb[k]=new f;if(j(kb,19,u)){A=0;return}o=g+q;k=0;for(var v=-1;k<o;)if(v++,h=
l(kb),16>h)u[k++]=h;else if(16==h){var w;h=3+d(2);if(k+h>o){A=0;return}for(w=k?u[k-1]:0;h--;)u[k++]=w}else{h=17==h?3+d(3):11+d(7);if(k+h>o){A=0;return}for(;h--;)u[k++]=0}o=Mb.length;for(k=0;k<o;k++)Mb[k]=new f;if(j(Mb,g,u)){A=0;return}o=Mb.length;for(k=0;k<o;k++)kb[k]=new f;h=[];for(k=g;k<u.length;k++)h[k-g]=u[k];if(j(kb,q,h)){A=0;return}for(;;)if(h=l(Mb),256<=h){h-=256;if(0==h)break;h--;o=d(P[h])+O[h];h=l(kb);8<R[h]?(q=d(8),q|=d(R[h]-8)<<8):q=d(R[h]);for(q+=fa[h];o--;)g=x[A-q&32767],e(g)}else e(h)}while(!a);
A=0;U=1}function o(){var a=[],c;u&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());F&&v(qa.byteLength);a[0]=b();if(8==a[0]){u=b();b();b();b();b();b();b();if(u&4){a[0]=b();a[2]=b();Ga=a[0]+256*a[1];for(a=0;a<Ga;a++)b()}if(u&8){a=0;for(vb=[];c=b();){if("7"==c||":"==c)a=0;a<pd-1&&(vb[a++]=c)}}if(u&16)for(;b(););u&2&&(b(),b());k();b();b();b();b();b();b();b();b();F&&v(qa.byteLength)}}function v(a){w=a;q=new Uint8Array(a);a=
[];F=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(k(),D[z]=Array(2),D[z][0]=q,D[z][1]="geonext.gxt",z++);31==a[0]&&139==a[1]&&(o(),D[z]=Array(2),D[z][0]=q,D[z][1]="file",z++);if(80==a[0]&&75==a[1]&&(F=n,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u=b();u|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(vb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<pd-1&&(vb[e++]=String.fromCharCode(f))}qd||(qd=vb);for(e=0;e<
d;)b(),e++;J=0;8==a&&(k(),D[z]=Array(2),D[z][0]=q,D[z][1]=vb.join(""),z++);o()}}var q=p,w=0,u,z=0,D=[],x=Array(32768),A=0,F=r,J=0,T=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],O=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],fa=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qa=a,Na=0,U=1,Ic=0,pd=256,vb=[],qd,Mb=Array(288),kb=Array(32),
Lb=0,Kc=p,Ga=0,ub=Array(17);ub[0]=0;var Jc,od;He.prototype.vf=function(){v(qa.byteLength);return q}};function Ie(){Td.call(this);this.c="parserDCM"}H(Ie,Td);Ie.prototype.parse=function(a,b,c){c=this.hd(c,b);if(c.Vd==c.cb){var d=c.qf.length,e,f=0;for(e=0;e<d;e++){var g=c.qf[e];g!==m&&(g*=c.gb,g=c.Xc.subarray(g,g+c.gb),c.data.set(g,f*c.gb),f++)}b.$=[c.va[0],c.va[1],c.va[2]];Infinity==c.na[2]&&(c.na[2]=1);b.I=[c.na[0],c.na[1],c.na[2]];e=Ud(c.data);d=e[0];e=e[1];c.min=b.Ka=b.W=d;c.max=b.Da=b.V=e;-Infinity==b.R&&(b.R=d);Infinity==b.U&&(b.U=e);De(b);b.ob=Wd(this,b,c)}c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};
Ie.prototype.hd=function(a,b){this.da=a;var c=0;if(B(b.gc)){g=b.gc;h=W(this,"ushort",this.da.byteLength-2*g.gb);j=0;for(l=2;0<l;)if(d=h[j++],32==d)if(f=h[j++],19==f){j++;d=h[j++];for(f=0;f<d/2;f++)k=h[j++],o=k&255,k=(k&65280)>>8,c+=String.fromCharCode(o),c+=String.fromCharCode(k),c=parseInt(c,10);l--}else if(4161==f){j++;for(var d=h[j++],e="",f=0;f<d/2;f++)k=h[j++],o=k&255,k=(k&65280)>>8,e+=String.fromCharCode(o),e+=String.fromCharCode(k);g.na=[g.na[0],g.na[1],Math.min(Math.abs(g.og-e),g.na[2])];
g.og=e;l--}g.va[2]++}else{var g={rows:0,cols:0,na:p,Ie:0,nh:0,cb:1,$h:1,og:p,Vd:0,gb:0,Xc:p,lf:0,qf:[],data:p,min:Infinity,max:-Infinity};g.cb=b.p.length;B(g.cb)||(g.cb=1);for(var h=W(this,"ushort",this.da.byteLength),j=66,d=p,f=p,d=p,l=7;0<l;)if(d=h[j++],40==d)switch(f=h[j++],j++,d=h[j++],f){case 16:g.rows=h[j++];l--;break;case 17:g.cols=h[j++];l--;break;case 256:g.Ie=h[j++];l--;break;case 257:g.nh=h[j++];l--;break;case 2:g.$h=h[j++];l--;break;case 48:e="";for(f=f=0;f<d/2;f++)var k=h[j++],o=k&255,
k=(k&65280)>>8,e=e+String.fromCharCode(o),e=e+String.fromCharCode(k);e=e.split("\\");g.na=[+e[0],+e[1],Infinity];l--}else if(32==d&&(f=h[j++],19==f)){j++;d=h[j++];for(f=0;f<d/2;f++)k=h[j++],o=k&255,k=(k&65280)>>8,c+=String.fromCharCode(o),c+=String.fromCharCode(k),c=parseInt(c,10);l--}b.gc=g;g.va=[g.cols,g.rows,1];g.gb=g.rows*g.cols;switch(g.Ie){case 8:g.Xc=new Uint8Array(g.cols*g.rows*g.cb);g.data=new Uint8Array(g.cols*g.rows*g.cb);break;case 16:g.Xc=new Uint16Array(g.cols*g.rows*g.cb);g.data=new Uint16Array(g.cols*
g.rows*g.cb);break;case 32:g.Xc=new Uint32Array(g.cols*g.rows*g.cb),g.data=new Uint32Array(g.cols*g.rows*g.cb)}}this.B=this.da.byteLength-2*g.gb;h=p;switch(g.Ie){case 8:h=W(this,"uchar",g.gb);break;case 16:h=W(this,"ushort",g.gb);break;case 32:h=W(this,"uint",g.gb)}g.qf[c]=g.lf;g.Xc.set(h,g.lf*g.gb);g.lf++;++g.Vd;return g};G("X.parserDCM",Ie);G("X.parserDCM.prototype.parse",Ie.prototype.parse);function Je(){Td.call(this);this.c="parserVTK"}H(Je,Td);
Je.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new S(c.byteLength);b.h=e=new S(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=Vd(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.Uc=this.Vc=p;this.Lb=[];this.ta=rd;this.ve=this.zb=this.nb=this.Ab=r;c=0;for(h=g%8;h--;)Ke(this,f[c]),c++;for(h=0.125*g^0;h--;)Ke(this,f[c]),c++,Ke(this,f[c]),c++,Ke(this,f[c]),c++,Ke(this,f[c]),c++,Ke(this,f[c]),c++,Ke(this,f[c]),c++,Ke(this,f[c]),c++,
Ke(this,f[c]),c++;var c=this.Vc,f=this.Uc,g=f.length,j=h=this.Lb.length;do{var l=this.Lb[h-j],k=l.length,o;for(o=0;o<k&&!("LINES"==this.ta&&o+1>=k);o++){var v=parseInt(l[o],10),q=c.get(v);d.add(q[0],q[1],q[2]);var w=v,u=q;"LINES"==this.ta?(w=parseInt(l[o+1],10),u=c.get(w),d.add(u[0],u[1],u[2])):"TRIANGLE_STRIPS"==this.ta&&(0==o||o==k-1)&&d.add(q[0],q[1],q[2]);v<g?(u=f.get(v),e.add(u[0],u[1],u[2]),"LINES"==this.ta?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==this.ta&&(0==o||o==k-1)&&e.add(u[0],
u[1],u[2])):(w=new N(q[0],q[1],q[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.ta?(w=new N(u[0],u[1],u[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.ta&&(0==o||o==k-1)&&e.add(w.x,w.y,w.b))}j--}while(0<j);b.ma=this.ta;I.Ca(this.c+".parse");d=new ud;d.ea=b;d.t=a;this.dispatchEvent(d)};
function Ke(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.Ab=n;a.nb=r;a.zb=r;c=parseInt(c[1],10);a.Vc=new S(3*c);a.Uc=new S(3*c);return;case "VERTICES":a.nb=n;a.Ab=r;a.zb=r;c=parseInt(c[1],10);3<=c?a.ta=rd:1==c?a.ta="POINTS":i(Error("This VTK file is not supported!"));a.Lb=[];return;case "TRIANGLE_STRIPS":a.nb=n;a.Ab=r;a.zb=r;a.ta="TRIANGLE_STRIPS";a.Lb=[];return;case "LINES":a.nb=n;a.Ab=r;a.zb=r;a.ta="LINES";a.Lb=[];return;case "POLYGONS":a.nb=n;
a.Ab=r;a.zb=r;a.ta="POLYGONS";a.Lb=[];return;case "POINT_DATA":a.zb=n;a.Ab=r;a.nb=r;return}if(a.Ab)if(1==d||isNaN(parseFloat(e)))a.Ab=r;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Vc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Vc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Vc.add(d,e,c))}else a.nb?1==d||isNaN(parseFloat(e))?a.nb=r:a.Lb.push(c.slice(1)):a.zb&&("NORMALS"==e?a.ve=n:1==d||isNaN(parseFloat(e))?
(a.zb=r,a.ve=r):a.ve&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Uc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Uc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Uc.add(d,e,c))))}G("X.parserVTK",Je);G("X.parserVTK.prototype.parse",Je.prototype.parse);function Le(){Td.call(this);this.c="parserFSM";this.ud=r}H(Le,Td);
Le.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");this.da=c;var d=b.g,e=b.h;b.oc=[];var f=b.oc,c=0,g;do g=W(this,"uchar"),c++;while(200>c&&10!=g);W(this,"uchar");var e=W(this,"uint"),c=W(this,"uint"),h=W(this,"float",3*e);g=W(this,"uint",3*c);var j=new Uint32Array(e),l=new Float32Array(9*c);b.g=d=new S(9*c);b.h=e=new S(9*c);var k;for(k=0;k<c;k++){var o=3*k,v=g[o],q=g[o+1],w=g[o+2];f.push(v);f.push(q);f.push(w);j[v]+=1;j[q]+=1;j[w]+=1;var o=3*v,u=3*q,z=3*w,D=h[o],x=h[o+1],A=h[o+2],q=h[u],w=
h[u+1],v=h[u+2],F=h[z],J=h[z+1],T=h[z+2];d.add(D,x,A);d.add(q,w,v);d.add(F,J,T);D=new N(D,x,A);F=new N(F,J,T);q=(new N(q,w,v)).f().Ta(D);w=F.f().Ta(D);q=Uc(q,w).normalize();l[o]+=q.x;l[o+1]+=q.y;l[o+2]+=q.b;l[u]+=q.x;l[u+1]+=q.y;l[u+2]+=q.b;l[z]+=q.x;l[z+1]+=q.y;l[z+2]+=q.b}for(k=0;k<c;k++)o=3*k,v=g[o],q=g[o+1],w=g[o+2],o=3*v,u=3*q,z=3*w,f=new N(l[u],l[u+1],l[u+2]),h=new N(l[z],l[z+1],l[z+2]),o=(new N(l[o],l[o+1],l[o+2])).scale(1/j[v]).normalize(),f=f.scale(1/j[q]).normalize(),h=h.scale(1/j[w]).normalize(),
e.add(o.x,o.y,o.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ma=rd;I.Ca(this.c+".parse");c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};G("X.parserFSM",Le);G("X.parserFSM.prototype.parse",Le.prototype.parse);function Me(){Td.call(this);this.c="parserMGZ";this.ud=r}H(Me,Td);Me.prototype.parse=function(a,b,c,d){I.Ia(this.c+".parse");var e=c;d&&(e=(new He(new Uint8Array(c))).vf(),e=e.buffer);c=this.hd(e);b.$=[c.af,c.bf,c.cf];b.I=c.Rg;d=c.min;e=c.max;b.Ka=b.W=d;b.Da=b.V=e;-Infinity==b.R&&(b.R=d);Infinity==b.U&&(b.U=e);De(b);I.Ca(this.c+".parse");b.ob=Wd(this,b,c);c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};
Me.prototype.hd=function(a){this.da=a;a={version:0,Zg:0,Xg:0,Eh:0,Yg:0,af:0,bf:0,cf:0,Zh:0,type:0,xh:0,Hg:0,tj:p,Wg:p,Rg:p,data:p,min:Infinity,max:-Infinity};a.version=W(this,"uint");a.af=W(this,"uint");a.bf=W(this,"uint");a.cf=W(this,"uint");a.Zh=W(this,"uint");a.type=W(this,"uint");a.xh=W(this,"uint");a.Hg=W(this,"ushort");if(0<a.Hg){a.Rg=W(this,"float",3);var b=[];b.push(W(this,"float",3));b.push(W(this,"float",3));b.push(W(this,"float",3));b.push(W(this,"float",3));a.Wg=b}this.B=284;b=a.af*a.bf*
a.cf;switch(a.type){case 0:a.data=W(this,"uchar",b);break;case 1:a.data=W(this,"uint",b);break;case 3:a.data=W(this,"float",b);break;case 4:a.data=W(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Ud(a.data);a.min=b[0];a.max=b[1];this.B+16<this.da.byteLength&&(a.Zg=W(this,"float"),a.Eh=W(this,"float"),a.Xg=W(this,"float"),a.Yg=W(this,"float"));return a};G("X.parserMGZ",Me);G("X.parserMGZ.prototype.parse",Me.prototype.parse);function Ne(){Td.call(this);this.c="parserCRV";this.ud=r}H(Ne,Td);
Ne.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");var d=b.oc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.da=c;this.B=3;var e=W(this,"uint");W(this,"uint");W(this,"uint");var f=0,g=0,h=0,j=0,l=0,k=0,o=0,v=0,q=0,w=0,u=0,c=Array(2),z=Array(2),D=W(this,"float",e),x;for(x=0;x<e;x++){var A=D[x];0==x&&(c[0]=z[0]=A);0<=A?(f++,j+=A):(g++,h+=A);q+=A;u++;z[0]=Math.max(A,z[0]);c[0]=Math.min(A,c[0]);D[x]=A}0!=f&&(l=j/f);0!=g&&(k=h/g);0!=u&&(w=q/u);for(u=q=h=j=0;u<e;u++)A=D[u],
x=0,0<=A?(x=Math.pow(A-l,2),j+=x):(x=Math.pow(A-k,2),h+=x),x=Math.pow(A-w,2),q+=x;1<f&&(o=Math.sqrt(j/(f-1)));1<g&&(v=Math.sqrt(h/(g-1)));c[1]=k-2.5*v;z[1]=l+2.5*o;e=d.length;f=new Float32Array(3*e);for(u=0;u<e;u++)g=D[d[u]],h=3*u,f[h]=g,f[h+1]=g,f[h+2]=g;b.u.Ka=c[1];b.u.Da=z[1];-Infinity==b.u.R&&(b.u.R=c[1]);Infinity==b.u.U&&(b.u.U=z[1]);b.u.r=D;b.u.Fc=f;b.u.e=n;I.Ca(this.c+".parse");d=new ud;d.ea=b;d.t=a;this.dispatchEvent(d)};G("X.parserCRV",Ne);G("X.parserCRV.prototype.parse",Ne.prototype.parse);function Oe(){Td.call(this);this.c="parserTRK"}H(Oe,Td);
Oe.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");var d=b.g,e=b.h,f=b.Z;this.da=c;W(this,"uchar",6);W(this,"ushort",3);var g=W(this,"float",3);W(this,"float",3);var h=W(this,"ushort");W(this,"uchar",200);W(this,"ushort");W(this,"uchar",200);W(this,"float",16);W(this,"uchar",444);W(this,"uchar",4);W(this,"uchar",4);W(this,"float",6);W(this,"uchar",2);W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");W(this,"uchar");var j=W(this,"uint");W(this,"uint");var l=W(this,
"uint"),k=[],o=[],c=Infinity,v=-Infinity,q=p,w=p,u=p,z=p,e=d=p,D=W(this,"uint",(this.da.byteLength-1E3)/4);this.B=l;for(var x=W(this,"float",(this.da.byteLength-1E3)/4),A=0,l=f=0;l<j;l++){for(var F=D[A],J=new S(3*F),T=0,O=0;O<F;O++){var P=x[A+3*O+O*h+1],fa=x[A+3*O+O*h+2],R=x[A+3*O+O*h+3],P=P/g[0],fa=fa/g[1],R=R/g[2];J.add(P,fa,R);if(0<O)var aa=J.get(O-1),T=T+Math.sqrt(Math.pow(P-aa[0],2)+Math.pow(fa-aa[1],2)+Math.pow(R-aa[2],2));O<F-1&&(f+=6)}A+=3*F+F*h+1;O=J.Rb;F=J.Ob;P=J.Sb;fa=J.Pb;R=J.Tb;aa=J.Qb;
if(!q||O<q)q=O;if(!w||F>w)w=F;if(!u||P<u)u=P;if(!z||fa>z)z=fa;if(!d||R<d)d=R;if(!e||aa>e)e=aa;k.push(J);o.push(T)}g=(q+w)/2;u=(u+z)/2;h=(d+e)/2;z=new Float32Array(f);b.g=d=new S(f);b.h=e=new S(f);b.Z=f=new S(f);for(l=q=0;l<j;l++){w=k[l];D=w.count;T=o[l];c=Math.min(c,T);v=Math.max(v,T);for(O=0;O<D-1;O++){A=w.get(O);x=w.get(O+1);d.add(A[0],A[1],A[2]);d.add(x[0],x[1],x[2]);var J=A[0]-g,F=A[1]-u,P=A[2]-h,fa=Math.sqrt(J*J+F*F+P*P),R=x[0]-g,aa=x[1]-u,qa=x[2]-h,Na=Math.sqrt(R*R+aa*aa+qa*qa);e.add(J/fa,F/
fa,P/fa);e.add(R/Na,aa/Na,qa/Na);x=[Math.abs(x[0]-A[0]),Math.abs(x[1]-A[1]),Math.abs(x[2]-A[2])];A=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]);x[0]/=A;x[1]/=A;x[2]/=A;f.add(x[0],x[1],x[2]);f.add(x[0],x[1],x[2]);z[q++]=T;z[q++]=T;z[q++]=T;z[q++]=T;z[q++]=T;z[q++]=T}}b.ma="LINES";j=new td;j.Ka=c;j.Da=v;j.R=c;j.U=v;j.Fc=z;j.Pf=r;j.e=n;b.u=j;I.Ca(this.c+".parse");c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};G("X.parserTRK",Oe);G("X.parserTRK.prototype.parse",Oe.prototype.parse);function Pe(){Td.call(this);this.c="parserIMAGE"}H(Pe,Td);Pe.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;sc(f,"load",this.Bi.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Pe.prototype.Bi=function(a,b,c){b.ob=a;b.la=p;a=new ud;a.ea=c;a.t=b;this.dispatchEvent(a)};G("X.parserIMAGE",Pe);G("X.parserIMAGE.prototype.parse",Pe.prototype.parse);function Qe(){Td.call(this);this.c="parserLUT"}H(Qe,Td);
Qe.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");this.da=c;var c=W(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=Vd(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.Ca(this.c+".parse");c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};
G("X.parserLUT",Qe);G("X.parserLUT.prototype.parse",Qe.prototype.parse);function Re(){Td.call(this);this.c="parserNRRD"}H(Re,Td);
Re.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");this.da=c;var c=W(this,"uchar",c.byteLength),d=c.length,e=p,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=Vd(c,0,g-2);f=g+1;break}var h,j,l,k,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Vh=n;else if(!h.match(/^#/)&&(k=h.match(/(.*):(.*)/)))j=k[1].trim(),h=k[2].trim(),(l=this.Ah[j])?l.call(this,h):this[j]=h;this.Vh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&
i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Ha&&(this.Ha=[new N(1,0,0),new N(0,1,0),new N(0,0,1)],this.rf)){d=[];for(k=0;2>=k;k++)d.push(!isNaN(this.rf[k])?this.Ha[k].scale(this.rf[k]):m)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new He(f)).vf();f=f.buffer;c={data:p,min:Infinity,max:-Infinity};c.data=new this.Hb(f);k=Ud(c.data);f=c.min=k[0];k=c.max=k[1];b.$=[this.of[0],this.of[1],this.of[2]];b.I=[(new N(this.Ha[0][0],this.Ha[0][1],this.Ha[0][2])).dc(),(new N(this.Ha[1][0],
this.Ha[1][1],this.Ha[1][2])).dc(),(new N(this.Ha[2][0],this.Ha[2][1],this.Ha[2][2])).dc()];b.Ka=b.W=f;b.Da=b.V=k;-Infinity==b.R&&(b.R=f);Infinity==b.U&&(b.U=k);De(b);I.Ca(this.c+".parse");b.ob=Wd(this,b,c);c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};
Re.prototype.Ah={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Hb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Hb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Hb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Hb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Hb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Hb=Uint32Array;break;case "float":this.Hb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.va=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.of=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Ha=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.rf=e}};G("X.parserNRRD",Re);G("X.parserNRRD.prototype.parse",Re.prototype.parse);function Se(){Td.call(this);this.c="parserNII"}H(Se,Td);Se.prototype.parse=function(a,b,c){I.Ia(this.c+".parse");var d=c,e=-1,e="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,n);348!=e&&(d=(new He(new Uint8Array(c))).vf(),d=d.buffer);c=this.hd(d);b.$=[c.va[1],c.va[2],c.va[3]];b.I=[c.na[1],c.na[2],c.na[3]];d=c.min;e=c.max;b.Ka=b.W=d;b.Da=b.V=e;-Infinity==b.R&&(b.R=d);Infinity==b.U&&(b.U=e);De(b);I.Ca(this.c+".parse");b.ob=Wd(this,b,c);c=new ud;c.ea=b;c.t=a;this.dispatchEvent(c)};
Se.prototype.hd=function(a){this.da=a;a={Yi:0,rh:p,sh:p,zh:0,Si:0,Ki:0,vh:p,va:p,Qh:0,Rh:0,Sh:0,Oh:0,Qe:0,mh:0,bj:0,na:p,Sg:0,Ri:0,Qi:0,aj:0,Zi:p,pj:p,oh:0,ph:0,$i:0,ij:0,Gh:0,Hh:0,uh:p,lh:p,Di:0,Wi:0,Hi:0,Ii:0,Ji:0,Ei:0,Fi:0,Gi:0,cj:p,dj:p,ej:p,Ph:p,Wh:p,data:p,min:Infinity,max:-Infinity};a.Yi=W(this,"uint");a.rh=W(this,"uchar",10);a.sh=W(this,"uchar",18);a.zh=W(this,"uint");a.Si=W(this,"ushort");a.Ki=W(this,"uchar");a.vh=W(this,"uchar");a.va=W(this,"ushort",8);a.Qh=W(this,"float");a.Rh=W(this,"float");
a.Sh=W(this,"float");a.Oh=W(this,"ushort");a.Qe=W(this,"ushort");a.mh=W(this,"ushort");a.bj=W(this,"ushort");a.na=W(this,"float",8);a.Sg=W(this,"float");a.Ri=W(this,"float");a.Qi=W(this,"float");a.aj=W(this,"ushort");a.Zi=W(this,"uchar");a.pj=W(this,"uchar");a.oh=W(this,"float");a.ph=W(this,"float");a.$i=W(this,"float");a.ij=W(this,"float");a.Gh=W(this,"uint",1);a.Hh=W(this,"uint",1);a.uh=W(this,"uchar",80);a.lh=W(this,"uchar",24);a.Di=W(this,"ushort");a.Wi=W(this,"ushort");a.Hi=W(this,"float");a.Ii=
W(this,"float");a.Ji=W(this,"float");a.Ei=W(this,"float");a.Fi=W(this,"float");a.Gi=W(this,"float");a.cj=W(this,"float",4);a.dj=W(this,"float",4);a.ej=W(this,"float",4);a.Ph=W(this,"uchar",16);a.Wh=W(this,"uchar",4);this.B=parseInt(a.Sg,10);var b=a.va[1]*a.va[2]*a.va[3];switch(a.Qe){case 2:a.data=W(this,"uchar",b);break;case 4:a.data=W(this,"sshort",b);break;case 8:a.data=W(this,"sint",b);break;case 16:a.data=W(this,"float",b);break;case 256:a.data=W(this,"schar",b);break;case 512:a.data=W(this,"ushort",
b);break;case 768:a.data=W(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Qe))}b=Ud(a.data);a.min=b[0];a.max=b[1];return a};G("X.parserNII",Se);G("X.parserNII.prototype.parse",Se.prototype.parse);function Te(){L.call(this);this.c="loader";this.mc=new Ob;this.Sc=0}H(Te,L);function Ue(a,b){a.Sc+=b/a.mc.bb()/3;a.Sc=Math.min(1,a.Sc);var c=new Sd;c.Rf=a.Sc;a.dispatchEvent(c)}function Ve(a){var a=a.p.zd,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in We||i(Error("The "+b+" file format is not supported."));return[a,b,We[b][0],We[b][1],We[b][2]]}
Te.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Qb(this.mc.F,a.ga)||this.mc.get(a.ga)){this.mc.set(a.ga,r);var c=Ve(a)[0];if(a.Kb!=p)this.parse(p,a,b);else{var d=new XMLHttpRequest;K(d,"abort",this.cg.bind(this,d,a,b));K(d,"error",this.cg.bind(this,d,a,b));K(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,n);d.responseType="arraybuffer";d.send(p)}}};
Te.prototype.parse=function(a,b,c){Ue(this,1);setTimeout(function(){var d=Ve(b),e=d[3],d=new d[2];sc(d,yc,this.complete.bind(this));var f=b.Kb;f==p&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Te.prototype.complete=function(a){Ue(this,1);setTimeout(function(){var b=a.t,c=a.ea;b.p.e=r;b.e=n;c.o();this.mc.set(b.ga,n)}.bind(this),100)};Te.prototype.cg=function(a,b,c){i(Error("Loading failed: ",b,c))};
var We={STL:[Ge,p],VTK:[Je,p],TRK:[Oe,p],FSM:[Le,p],INFLATED:[Le,p],SMOOTHWM:[Le,p],SPHERE:[Le,p],PIAL:[Le,p],ORIG:[Le,p],NRRD:[Re,p],NII:[Se,p],GZ:[Se,p],DCM:[Ie,p],DICOM:[Ie,p],"":[Ie,p],CRV:[Ne,p],LABEL:[ae,p],MGH:[Me,r],MGZ:[Me,n],TXT:[Qe,p],LUT:[Qe,p],PNG:[Pe,"png"],JPG:[Pe,"jpeg"],JPEG:[Pe,"jpeg"],GIF:[Pe,"gif"]};function Xe(a,b){(!E(a)||!E(b))&&i(Error("A camera needs valid width and height values."));L.call(this);this.c="camera";this.ua=new N(0,0,100);this.kc=new N(0,0,0);this.J=new N(0,1,0);this.m=this.Xd(this.ua,this.kc);this.Mb=new Float32Array(this.m.Fa())}H(Xe,L);Xe.prototype.oi=function(a){a instanceof Md||i(Error("Received no valid rotate event."));this.rotate(a.L)};Xe.prototype.Ai=function(a){a instanceof Nd||i(Error("Received no valid zoom event."));a.Wa?this.Tg(a.Ja):this.Ug(a.Ja)};
Xe.prototype.li=function(a){a instanceof Ld||i(Error("Received no valid pan event."));this.Dg(a.L)};Xe.prototype.__defineGetter__("view",t("m"));Xe.prototype.__defineSetter__("view",function(a){(!B(a)||!(a instanceof hd))&&i(Error("Invalid view matrix."));this.m=a;this.Mb=new Float32Array(this.m.Fa())});Xe.prototype.__defineGetter__("position",function(){return[this.ua.x,this.ua.y,this.ua.b]});
Xe.prototype.__defineSetter__("position",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid position."));this.ua=new N(a[0],a[1],a[2]);this.reset()});Xe.prototype.__defineGetter__("focus",function(){return[this.kc.x,this.kc.y,this.kc.b]});Xe.prototype.__defineSetter__("focus",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid focus"));this.kc=new N(a[0],a[1],a[2]);this.reset()});Xe.prototype.__defineGetter__("up",function(){return[this.J.x,this.J.y,this.J.b]});
Xe.prototype.__defineSetter__("up",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid up vector."));this.J=new N(a[0],a[1],a[2]);this.reset()});y=Xe.prototype;y.reset=function(){this.m=this.Xd(this.ua,this.kc);this.Mb=new Float32Array(this.m.Fa())};y.rotate=function(a){C(a)&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for rotate operation."));return a};
y.Dg=function(a){C(a)&&2==a.length?a=new Xc(a[0],a[1]):a instanceof Xc||i(Error("Invalid distance vector for pan operation."));a=new N(-a.x,a.y,0);a=id(4).translate(a);this.m=new hd(a.multiply(this.m));this.Mb=new Float32Array(this.m.Fa())};y.Tg=function(a){var b=20;B(a)&&!a&&(b=1);a=new N(0,0,b);a=id(4).translate(a);this.m=new hd(a.multiply(this.m));this.Mb=new Float32Array(this.m.Fa())};
y.Ug=function(a){var b=30;B(a)&&!a&&(b=1);a=new N(0,0,-b);a=id(4).translate(a);this.m=new hd(a.multiply(this.m));this.Mb=new Float32Array(this.m.Fa())};y.Xd=function(a,b){(!(a instanceof N)||!(b instanceof N))&&i(Error("3D vectors required for calculating the view."));return id(4)};G("X.camera",Xe);G("X.camera.prototype.pan",Xe.prototype.Dg);G("X.camera.prototype.rotate",Xe.prototype.rotate);G("X.camera.prototype.zoomIn",Xe.prototype.Tg);G("X.camera.prototype.zoomOut",Xe.prototype.Ug);function Ye(a){function b(a,b,d){b=2*b*Math.PI;b=j.Gb(Math.cos(b)).yc(l.Gb(Math.sin(b)));a=c.yc(e.Gb(a)).yc(b.Gb(f));d=b.Gb(1-Math.abs(d)).yc(g.Gb(d));return new Ec(a,d)}this.A=[];for(var a=a||{},c=new ua(a.start||[0,-1,0]),d=new ua(a.end||[0,1,0]),e=d.fd(c),f=a.eb||1,a=a.pf||16,g=e.nd(),h=0.5<Math.abs(g.y()),j=(new ua(h,!h,0)).Oe(g).nd(),l=j.Oe(g).nd(),h=new Ec(c,g.df()),d=new Ec(d,g.nd()),k=[],o=0;o<a;o++){var v=o/a,q=(o+1)/a;k.push(new Gc([h,b(0,v,-1),b(0,q,-1)]));k.push(new Gc([b(0,q,0),b(0,v,
0),b(1,v,0),b(1,q,0)]));k.push(new Gc([d,b(1,q,1),b(1,v,1)]))}return Mc(k)}H(Ye,Lc);function Ze(){V.call(this);this.c="cylinder";this.Ee=[-10,-10,-10];this.ie=[10,10,10];this.Ub=10;this.Xb=32;va(this,new wd)}H(Ze,V);Ze.prototype.__defineGetter__("start",t("Ee"));Ze.prototype.__defineSetter__("start",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid start"));this.Ee=a});Ze.prototype.__defineGetter__("end",t("ie"));Ze.prototype.__defineSetter__("end",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid end"));this.ie=a});Ze.prototype.__defineGetter__("radius",t("Ub"));
Ze.prototype.__defineSetter__("radius",function(a){E(a)||i(Error("Invalid radius."));this.Ub=a});Ze.prototype.o=function(){yd(this,new Ye({start:this.Ee,end:this.ie,eb:this.Ub,pf:this.Xb}));Ze.j.o.call(this)};G("X.cylinder",Ze);G("X.cylinder.prototype.modified",Ze.prototype.o);function $e(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new ua(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Ec(c.yc(e.Gb(d)),e))}this.A=[];for(var a=a||{},c=new ua(a.Ke||[0,0,0]),d=a.eb||1,e=a.pf||16,a=a.fj||8,f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new Gc(g));return Mc(f)}H($e,Lc);function af(){V.call(this);this.c="sphere";this.l=[0,0,0];this.Ub=5;this.Xb=32;this.gh=16;va(this,new wd)}H(af,V);af.prototype.__defineGetter__("center",t("l"));af.prototype.__defineSetter__("center",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});af.prototype.__defineGetter__("radius",t("Ub"));af.prototype.__defineSetter__("radius",function(a){E(a)||i(Error("Invalid radius."));this.Ub=a});
af.prototype.o=function(){yd(this,new $e({Ke:this.l,eb:this.Ub,pf:this.Xb,fj:this.gh}));af.j.o.call(this)};G("X.sphere",af);G("X.sphere.prototype.modified",af.prototype.o);function Fe(a){M.call(this);this.c="labelmap";this.kb=a}H(Fe,M);Fe.prototype.o=function(){var a=new ud;a.ea=this;this.dispatchEvent(a);this.kb.o()};G("X.labelmap",Fe);function bf(a){this.A=[];var a=a||{},b=new ua(a.Ke||[0,0,0]),c=!a.eb?[1,1,1]:a.eb.length?a.eb:[a.eb,a.eb,a.eb];return Mc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Gc(a[0].map(function(e){e=new ua(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Ec(e,new ua(a[1]))}))}))}H(bf,Lc);function cf(){V.call(this);this.c="cube";this.l=[0,0,0];this.re=this.qe=this.pe=20;this.Yb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];va(this,new wd)}H(cf,V);cf.prototype.__defineGetter__("center",t("l"));cf.prototype.__defineSetter__("center",function(a){(!B(a)||!C(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});cf.prototype.__defineGetter__("lengthX",t("pe"));
cf.prototype.__defineSetter__("lengthX",function(a){E(a)||i(Error("Invalid lengthX."));this.pe=a});cf.prototype.__defineGetter__("lengthY",t("qe"));cf.prototype.__defineSetter__("lengthY",function(a){E(a)||i(Error("Invalid lengthY."));this.qe=a});cf.prototype.__defineGetter__("lengthZ",t("re"));cf.prototype.__defineSetter__("lengthZ",function(a){E(a)||i(Error("Invalid lengthZ."));this.re=a});cf.prototype.o=function(){yd(this,new bf({Ke:this.l,eb:[this.pe/2,this.qe/2,this.re/2]}));cf.j.o.call(this)};
G("X.cube",cf);G("X.cube.prototype.modified",cf.prototype.o);function ze(a){Y.call(this,a);this.c="interactor3D"}H(ze,Y);ze.prototype.gd=function(a){ze.j.gd.call(this,a);var b=new Nd;B(a.uc)||(a.uc=0);b.Wa=0>a.uc;b.Ja=n;this.dispatchEvent(b)};function df(a){L.call(this);this.c="array";this.r=[];this.Af=a}H(df,L);df.prototype.add=function(a){this.r.push(a);return n};df.prototype.remove=function(a){a=this.r.indexOf(a);-1<a&&this.r.splice(a,1);return n};df.prototype.clear=function(){this.r.length=0};
function ef(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);ef(a,b,d);for(ef(a,d,c);b<d;++b)if(0<a.Af(a.r[b],a.r[d])){var e=a.r[b];a.r[b]=a.r[d];for(var f=a,g=d,h=c;g+1<h&&0>f.Af(f.r[g+1],e);){var j=f,l=g+1,k=j.r[g];j.r[g]=j.r[l];j.r[l]=k;++g}f.r[g]=e}}}df.prototype.sort=function(){ef(this,0,this.r.length)};function ff(a,b){Xe.call(this,a,b);this.c="camera2D"}H(ff,Xe);ff.prototype.rotate=function(a){var a=ff.j.rotate.call(this,a),b=new Kd;0<a.x?b.Ge--:0>a.x&&b.Ge++;0<a.y?b.se++:0>a.y&&b.se--;this.dispatchEvent(b)};function gf(a,b){Xe.call(this,a,b);this.c="camera3D";this.Cf=45;this.Mf=new Float32Array(hf(this.Cf,a/b).Fa())}H(gf,Xe);function hf(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new hd([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
gf.prototype.rotate=function(a){var a=gf.j.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=id(4),d=new N(parseFloat(this.m.Y(0,0)),parseFloat(this.m.Y(0,1)),parseFloat(this.m.Y(0,2))),b=c.rotate(b,new N(parseFloat(this.m.Y(1,0)),parseFloat(this.m.Y(1,1)),parseFloat(this.m.Y(1,2)))),a=c.rotate(a,d);this.m=new hd(this.m.multiply(a.multiply(b)));this.Mb=new Float32Array(this.m.Fa())};
gf.prototype.Xd=function(a,b){gf.j.Xd.call(this,a,b);var c=id(4),d=new N(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.J.f();e.Yc(d)&&(e.b+=1.0E-6);var f=Uc(e,d),e=Uc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.ba())};G("X.camera3D",gf);function jf(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}jf.prototype.f=function(){return new jf(this.top,this.right,this.bottom,this.left)};jf.prototype.contains=function(a){return!this||!a?r:a instanceof jf?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function kf(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}kf.prototype.f=function(){return new kf(this.left,this.top,this.width,this.height)};kf.prototype.lg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,n}return r};
kf.prototype.contains=function(a){return a instanceof kf?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};kf.prototype.wa=function(){return new Zc(this.width,this.height)};function lf(a,b){var c=ie(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,p))?c[b]||c.getPropertyValue(b):""}function mf(a,b){return a.currentStyle?a.currentStyle[b]:p}function nf(a,b){return lf(a,b)||mf(a,b)||a.style&&a.style[b]}function of(a){a=a?9==a.nodeType?a:ie(a):document;return Ua&&!nb(9)&&!we(ge(a))?a.body:a.documentElement}
function pf(a){var b=a.getBoundingClientRect();Ua&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function qf(a){if(Ua&&!nb(8))return a.offsetParent;for(var b=ie(a),c=nf(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=nf(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return p}
function rf(a){for(var b=new jf(0,Infinity,Infinity,0),c=ge(a),d=c.Q.body,e=c.Q.documentElement,f=!Wa&&"CSS1Compat"==c.Q.compatMode?c.Q.documentElement:c.Q.body;a=qf(a);)if((!Ua||0!=a.clientWidth)&&(!Wa||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=nf(a,"overflow")){var g=sf(a),h;h=a;if(Va&&!lb("1.9")){var j=parseFloat(lf(h,"borderLeftWidth"));if(tf(h))var l=h.offsetWidth-h.clientWidth-j-parseFloat(lf(h,"borderRightWidth")),j=j+l;h=new Vc(j,parseFloat(lf(h,"borderTopWidth")))}else h=new Vc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.Q.parentWindow||c.Q.defaultView||window;e=c.document;Wa&&!lb("500")&&!Ya?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Zc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Zc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:p}
function sf(a){var b,c=ie(a),d=nf(a,"position"),e=Va&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Vc(0,0),g=of(c);if(a==g)return f;if(a.getBoundingClientRect)b=pf(a),a=xe(ge(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Wa&&"fixed"==nf(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ta||Wa&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=qf(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Ta||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function uf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function vf(a){if("none"!=nf(a,"display"))return wf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=wf(a);b.display=c;b.position=e;b.visibility=d;return a}function wf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Wa&&!b&&!c;return(!ga(b)||d)&&a.getBoundingClientRect?(a=pf(a),new Zc(a.right-a.left,a.bottom-a.top)):new Zc(b,c)}function xf(a,b){a.style.display=b?"":"none"}function tf(a){return"rtl"==nf(a,"direction")}
function yf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var zf={thin:2,medium:4,thick:6};function Af(a,b){if("none"==mf(a,b+"Style"))return 0;var c=mf(a,b+"Width");return c in zf?zf[c]:yf(a,c)};function Bf(a){this.Qa=a;this.z=[]}H(Bf,Vb);var Cf=[];function Df(a,b,c,d,e){C(c)||(Cf[0]=c,c=Cf);for(var f=0;f<c.length;f++)a.z.push(K(b,c[f],d||a,e||r,a.Qa||a))}Bf.prototype.$d=function(){xb(this.z,uc);this.z.length=0};Bf.prototype.P=function(){Bf.j.P.call(this);this.$d()};Bf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function Ef(){}(function(a){a.dg=function(){return a.Nh||(a.Nh=new a)}})(Ef);Ef.prototype.ef=0;Ef.dg();function Ff(a){this.ab=a||ge()}H(Ff,Dc);y=Ff.prototype;y.Lh=Ef.dg();y.kg=p;y.cc=r;y.q=p;y.xc=p;y.Kd=p;y.Wc=p;y.oj=r;y.i=t("q");y.nf=function(a){this.xc&&this.xc!=a&&i(Error("Method not supported"));Ff.j.nf.call(this,a)};y.Od=t("ab");y.tc=function(){this.q=this.ab.createElement("div")};y.fc=function(a){this.Fb(a)};y.Fb=function(a,b){this.cc&&i(Error("Component already rendered"));this.q||this.tc();a?a.insertBefore(this.q,b||p):this.ab.Q.body.appendChild(this.q);(!this.xc||this.xc.cc)&&this.Nd()};
y.Nd=function(){this.cc=n;Gf(this,function(a){!a.cc&&a.i()&&a.Nd()})};y.$c=function(){Gf(this,function(a){a.cc&&a.$c()});this.Sd&&this.Sd.$d();this.cc=r};y.P=function(){Ff.j.P.call(this);this.cc&&this.$c();this.Sd&&(this.Sd.Oa(),delete this.Sd);Gf(this,function(a){a.Oa()});!this.oj&&this.q&&te(this.q);this.xc=this.q=this.Wc=this.Kd=p};function Gf(a,b){a.Kd&&xb(a.Kd,b,m)}
y.removeChild=function(a,b){if(a){var c=ia(a)?a:a.kg||(a.kg=":"+(a.Lh.ef++).toString(36)),a=this.Wc&&c?(c in this.Wc?this.Wc[c]:m)||p:p;if(c&&a){var d=this.Wc;c in d&&delete d[c];Bb(this.Kd,a);b&&(a.$c(),a.q&&te(a.q));c=a;c==p&&i(Error("Unable to set parent component"));c.xc=p;Ff.j.nf.call(c,p)}}a||i(Error("Child is not in parent component"));return a};function Hf(){}H(Hf,Dc);y=Hf.prototype;y.wf=0;y.ed=0;y.$e=100;y.bg=0;y.sf=1;y.Uh=r;y.Yh=r;y.ce=function(a){a=If(this,a);this.wf!=a&&(this.wf=a+this.bg>this.$e?this.$e-this.bg:a<this.ed?this.ed:a,!this.Uh&&!this.Yh&&this.dispatchEvent("change"))};y.Rd=function(){return If(this,this.wf)};y.Qd=function(){return If(this,this.ed)};y.Pd=function(){return If(this,this.$e)};function If(a,b){return a.sf==p?b:a.ed+Math.round((b-a.ed)/a.sf)*a.sf};function Jf(a){this.ab=a||ge();this.zc=new Hf;K(this.zc,"change",this.Ih,r,this)}H(Jf,Ff);var Kf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};y=Jf.prototype;y.tc=function(){this.Ua=this.Od().tc("div","progress-bar-thumb");var a=Kf[this.Cg];this.q=this.Od().tc("div",a,this.Ua);Lf(this);this.i().setAttribute("aria-valuemin",this.Qd());this.i().setAttribute("aria-valuemax",this.Pd())};
y.Nd=function(){Jf.j.Nd.call(this);Ua&&7>bb&&K(this.i(),"resize",this.ee,r,this);this.ee();var a=this.i();a.setAttribute("role","progressbar");a.ik="progressbar";this.i().setAttribute("aria-live","polite")};y.$c=function(){Jf.j.$c.call(this);Mf(this)};function Mf(a){Ua&&7>bb&&tc(a.i(),"resize",a.ee,r,a)}y.Rd=function(){return this.zc.Rd()};y.ce=function(a){this.zc.ce(a);this.i()&&Lf(this)};function Lf(a){var b=a.Rd();a.i().setAttribute("aria-valuenow",b)}y.Qd=function(){return this.zc.Qd()};
y.Pd=function(){return this.zc.Pd()};y.Cg="horizontal";y.Ih=function(){this.ee();this.dispatchEvent("change")};y.ee=function(){if(this.Ua){var a=this.Qd(),b=this.Pd(),a=(this.Rd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Cg?Ua&&7>bb?(this.Ua.style.top=0,this.Ua.style.height="100%",b=this.Ua.offsetHeight,a=Math.round(a*b),this.Ua.style.top=b-a+"px",this.Ua.style.height=a+"px"):(this.Ua.style.top=100-b+"%",this.Ua.style.height=b+"%"):this.Ua.style.width=b+"%"}};
y.P=function(){Mf(this);Jf.j.P.call(this);this.Ua=p;this.zc.Oa()};function Nf(a,b){B(a)||i(Error("No valid parent element."));B(b)||i(Error("Invalid initial value."));Jf.call(this);this.c="progressbar";this.oa=a;this.Lf="";this.rd=this.jb=p;this.Jb=[];this.Jb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.ce(b);this.We()}H(Nf,Jf);
Nf.prototype.We=function(){if("static"==this.oa.style.position||""==this.oa.style.position)this.Lf=this.oa.style.position,this.oa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=me("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Jb[0]),d=document.createTextNode(this.Jb[1]),e=document.createTextNode(this.Jb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.jb=b;this.fc(this.oa);a=this.i();a.style.position="absolute";
a.style.top=(this.oa.clientHeight-5)/2+"px";a.style.left=(this.oa.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Of(a){var b=a.i().style.top,c=a.i().style.left;te(a.i());var d=new Nf(a.oa,100),e=d.i();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=m?e.firstElementChild:ue(e.firstChild)).classList.add("progress-bar-thumb-done");a.rd=d}
Nf.prototype.Ud=function(){this.jb&&te(this.jb);this.i()&&te(this.i());this.rd&&te(this.rd.i());this.rd=this.jb=p;this.oa.style.position=this.Lf};var Pf=ca.window;function Qf(a,b,c){ja(a)?c&&(a=ra(a,c)):a&&"function"==typeof a.handleEvent?a=ra(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Pf.setTimeout(a,b||0)};function Rf(){L.call(this);this.c="renderer";this.t=window.document.body;this.N=this.t.clientWidth;this.H=this.t.clientHeight;this.Nb=this.s=this.ka=p;this.Xa=new df(vd);this.$a=[];this.C=p;this.we=this.vd=this.wd=r;this.a=this.pa=p;this.K={PROGRESSBAR_ENABLED:n};this.yf=-1;window.console.log("XTK release 9 -- 2012-12-06 14:20:41 -- http://www.goXTK.com -- @goXTK")}H(Rf,L);y=Rf.prototype;y.mi=function(a){this.pa&&this.pa.ce(100*a.Rf)};y.ci=function(a){B(a)&&a instanceof ud&&a.ea&&this.fb(a.ea)};
y.hf=function(a){(!B(a)||!(a instanceof Pd))&&i(Error("Invalid hover event."))};y.ni=function(){var a=je(this.t);this.N=a.clientWidth;this.H=a.clientHeight;a=je(this.ka);a.width=this.N;a.height=this.H;"renderer3D"==this.c&&(this.a.viewport(0,0,this.N,this.H),this.s.Mf=new Float32Array(hf(this.s.Cf,this.ka.width/this.ka.height).Fa()));this.Bc()};y.jf=function(a){(!B(a)||!(a instanceof Od))&&i(Error("Invalid scroll event."))};Rf.prototype.__defineGetter__("config",t("K"));
Rf.prototype.__defineGetter__("interactor",t("Nb"));Rf.prototype.__defineGetter__("camera",t("s"));Rf.prototype.__defineGetter__("loadingCompleted",t("vd"));Rf.prototype.__defineGetter__("container",t("t"));Rf.prototype.__defineSetter__("container",function(a){B(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ia(b)&&(b=je(a));ka(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.t=b});y=Rf.prototype;y.Bc=function(){this.s.reset()};
function Sf(a){a.K.PROGRESSBAR_ENABLED&&a.pa&&!a.zf&&(Of(a.pa),a.zf=Qf(function(){this.zf=p;this.pa&&(this.pa.Ud(),this.pa=p);this.fc()}.bind(a),700))}
y.ja=function(a){var b=me("canvas");this.t.appendChild(b);this.N=this.t.clientWidth;this.H=this.t.clientHeight;b.width=this.N;b.height=this.H;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.t.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.C=new Te;K(this.C,Gd,this.mi.bind(this));this.ka=b;this.a=c;b=new ze(this.ka);"2d"==a&&(b=new Be(this.ka));b.ja();K(b,Ed,this.Bc.bind(this));K(b,Hd,this.hf.bind(this));K(b,Dd,this.jf.bind(this));this.Nb=b;b=new gf(this.N,this.H);"2d"==a&&(b=new ff(this.N,this.H));a=b;c=this.Nb;(!B(c)||!(c instanceof Y))&&i(Error("Could not observe the interactor."));K(c,Bd,a.oi.bind(a));K(c,Ad,a.li.bind(a));K(c,Cd,a.Ai.bind(a));this.s=b;K(window,"resize",this.ni,r,this)};
y.add=function(a){(a instanceof cf||a instanceof af||a instanceof Ze)&&a.o();this.$a.push(a);this.fb(a)};y.fb=function(a){(!this.ka||!this.a)&&i(Error("The renderer was not initialized properly."));B(a)||(window.console.log(a),i(Error("Illegal object.")));xc(a)||K(a,yc,this.ci.bind(this))};y.get=function(a){B(a)||i(Error("Invalid object id."));for(var b=this.Xa.r,c=b.length,d=0,d=0;d<c;d++)if(b[d].ga==a)return b[d];return p};
y.fc=function(){(!this.ka||!this.a)&&i(Error("The renderer was not initialized properly."));B(this.Of)||(this.C.mc.Me(r)?(this.K.PROGRESSBAR_ENABLED&&!this.pa&&(this.pa=new Nf(this.t,3)),this.we=this.vd=r,this.Of=Qf(function(){this.Of=p;this.fc()}.bind(this),100)):(!this.vd&&!this.we&&(this.we=n,eval("this.onShowtime()"),this.vd=n),this.pa?Sf(this):(this.yf=window.jd(this.fc.bind(this),this.ka),eval("this.onRender()"),this.Fb(r,n))))};y.Bg=ba();y.zg=ba();y.Fb=ba();
y.Md=function(){window.Jd(this.yf);this.C&&(delete this.C,this.C=p);this.pa&&(this.pa.Ud(),delete this.pa,this.pa=p);this.Xa.clear();delete this.Xa;this.$a.length=0;delete this.$a;delete this.C;this.C=p;delete this.s;this.s=p;delete this.Nb;this.Nb=p;delete this.a;this.a=p;te(this.ka);delete this.ka;this.ka=p};function Tf(){L.call(this);this.c="shaders";this.Dd="";this.Dd="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform int scalarsInterpolation;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        if (scalarsInterpolation == 1) {\n            vec3 zeroMaxColor;\n            vec3 zeroMinColor;\n            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n        } else {\n            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n          }\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.sd="";this.sd="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\nuniform vec3 rgbLowerThreshold;\nuniform vec3 rgbUpperThreshold;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (textureSum.r < rgbLowerThreshold.r ||\n       textureSum.r > rgbUpperThreshold.r) {\n     textureSum.r = 0.0;\n    }\n   if (textureSum.g < rgbLowerThreshold.g ||\n       textureSum.g > rgbUpperThreshold.g) {\n     textureSum.g = 0.0;\n    }\n   if (textureSum.b < rgbLowerThreshold.b ||\n       textureSum.b > rgbUpperThreshold.b) {\n     textureSum.b = 0.0;\n    }\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
H(Tf,L);
var Uf={Tj:"vertexPosition",Sj:"vertexNormal",Rj:"vertexColor",Vj:"vertexTexturePos",Uj:"vertexScalar"},Vf={Wj:"view",yj:"perspective",qj:"center",xj:"objectTransform",Nj:"useObjectColor",vj:"objectColor",Pj:"useScalars",Jj:"scalarsReplaceMode",Gj:"scalarsMin",Dj:"scalarsMax",Hj:"scalarsMinColor",Ej:"scalarsMaxColor",Ij:"scalarsMinThreshold",Fj:"scalarsMaxThreshold",Cj:"scalarsInterpolation",zj:"pointSize",wj:"objectOpacity",uj:"normal",Oj:"usePicking",Qj:"useTexture",Mj:"useLabelMapTexture",sj:"labelmapOpacity",
Kj:"textureSampler",Lj:"textureSampler2",Xj:"volumeLowerThreshold",ck:"volumeUpperThreshold",$j:"volumeScalarMin",Yj:"volumeScalarMax",ak:"volumeScalarMinColor",Zj:"volumeScalarMaxColor",ek:"volumeWindowLow",dk:"volumeWindowHigh",bk:"volumeTexture",Aj:"rgbLowerThreshold",Bj:"rgbUpperThreshold"};
function Wf(a){var b=Object.keys(Vf);Object.keys(Uf).every(function(a){a=Uf[a];return-1!=this.Dd.search(a)||-1!=this.sd.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Vf[a];return-1!=this.Dd.search(a)||-1!=this.sd.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Xf(a,b,c){B(a)||i(Error("Invalid GL Buffer."));B(b)||i(Error("Invalid number of items."));B(c)||i(Error("Invalid item size."));L.call(this);this.c="buffer";this.v=a;this.sb=b;this.tb=c}H(Xf,L);function Yf(a,b,c,d,e,f,g,h){var j,l=c.offsetParent;if(l){var k="HTML"==l.tagName||"BODY"==l.tagName;if(!k||"static"!=nf(l,"position"))j=sf(l),k||(j=Wc(j,new Vc(l.scrollLeft,l.scrollTop)))}l=sf(a);k=vf(a);l=new kf(l.x,l.y,k.width,k.height);(k=rf(a))&&l.lg(new kf(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=ge(a),o=ge(c);if(k.Q!=o.Q){var v=k.Q.body,o=o.Q.parentWindow||o.Q.defaultView,q=new Vc(0,0),w=ie(v)?ie(v).parentWindow||ie(v).defaultView:window,u=v;do{var z;if(w==o)z=sf(u);else{var D=u;
z=new Vc;if(1==D.nodeType)if(D.getBoundingClientRect)D=pf(D),z.x=D.left,z.y=D.top;else{var x=xe(ge(D)),D=sf(D);z.x=D.x-x.x;z.y=D.y-x.y}else{var x=ja(D.Fh),A=D;D.targetTouches?A=D.targetTouches[0]:x&&D.Ea.targetTouches&&(A=D.Ea.targetTouches[0]);z.x=A.clientX;z.y=A.clientY}}q.x+=z.x;q.y+=z.y}while(w&&w!=o&&(u=w.frameElement)&&(w=w.parent));v=Wc(q,sf(v));Ua&&!we(k)&&(v=Wc(v,xe(k)));l.left+=v.x;l.top+=v.y}a=(b&4&&tf(a)?b^2:b)&-5;b=new Vc(a&2?l.left+l.width:l.left,a&1?l.top+l.height:l.top);j&&(b=Wc(b,
j));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=rf(c))&&j)F.top-=j.y,F.right-=j.x,F.bottom-=j.y,F.left-=j.x;return Zf(b,c,d,f,F,g,h)}
function Zf(a,b,c,d,e,f,g){var a=a.f(),h=0,j=(c&4&&tf(b)?c^2:c)&-5,c=vf(b),g=g?g.f():c.f();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Va&&(La||ab)&&lb("1.9");f instanceof Vc?(a=f.x,f=f.y):(a=f,f=m);b.style.left=uf(a,e);b.style.top=uf(f,e);$c(c,g)||(a=we(ge(ie(b))),
Ua&&(!a||!lb("8"))?(c=b.style,a?(Ua?(a=yf(b,mf(b,"paddingLeft")),e=yf(b,mf(b,"paddingRight")),f=yf(b,mf(b,"paddingTop")),d=yf(b,mf(b,"paddingBottom")),a=new jf(f,e,d,a)):(a=lf(b,"paddingLeft"),e=lf(b,"paddingRight"),f=lf(b,"paddingTop"),d=lf(b,"paddingBottom"),a=new jf(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),Ua?(e=Af(b,"borderLeft"),f=Af(b,"borderRight"),d=Af(b,"borderTop"),b=Af(b,"borderBottom"),b=new jf(d,f,b,e)):(e=lf(b,"borderLeftWidth"),f=lf(b,"borderRightWidth"),d=lf(b,"borderTopWidth"),
b=lf(b,"borderBottomWidth"),b=new jf(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Va?b.MozBoxSizing="border-box":Wa?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function $f(){}$f.prototype.Sa=ba();function ag(a,b){this.element=a;this.Wf=b}H(ag,$f);ag.prototype.Sa=function(a,b,c){Yf(this.element,this.Wf,a,b,m,c)};function bg(a,b){this.Qa=new Bf(this);this.mf(a||p);b&&(this.Dc=b)}H(bg,Dc);y=bg.prototype;y.q=p;y.kh=n;y.Sf=p;y.ra=r;y.Xi=r;y.Ze=-1;y.Kh=r;y.yh=n;y.Dc="toggle_display";y.i=t("q");y.mf=function(a){this.ra&&i(Error("Can not change this state of the popup while showing."));this.q=a};
function cg(a,b){a.ld&&a.ld.stop();a.cd&&a.cd.stop();if(b){if(!a.ra&&a.ff()){a.q||i(Error("Caller must call setElement before trying to show the popup"));a.Sa();var c=ie(a.q);a.Kh&&Df(a.Qa,c,"keydown",a.ai,n);if(a.kh)if(Df(a.Qa,c,"mousedown",a.xg,n),Ua){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}Df(a.Qa,c,"mousedown",a.xg,n);Df(a.Qa,c,"deactivate",a.wg)}else Df(a.Qa,c,"blur",a.wg);
"toggle_display"==a.Dc?(a.q.style.visibility="visible",xf(a.q,n)):"move_offscreen"==a.Dc&&a.Sa();a.ra=n;a.ld?(sc(a.ld,"end",a.Ag,r,a),a.ld.play()):a.Ag()}}else dg(a)}y.Sa=da;function dg(a,b){if(!a.ra||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Qa&&a.Qa.$d();a.cd?(sc(a.cd,"end",sa(a.Vf,b),r,a),a.cd.play()):a.Vf(b);return n}
y.Vf=function(a){"toggle_display"==this.Dc?this.Xi?Qf(this.jg,0,this):this.jg():"move_offscreen"==this.Dc&&(this.q.style.left="-200px",this.q.style.top="-200px");this.ra=r;this.gf(a)};y.jg=function(){this.q.style.visibility="hidden";xf(this.q,r)};y.ff=function(){return this.dispatchEvent("beforeshow")};y.Ag=function(){this.Ze=ta();this.dispatchEvent("show")};y.gf=function(a){ta();this.dispatchEvent({type:"hide",target:a})};
y.xg=function(a){a=a.target;!ve(this.q,a)&&(!this.Sf||ve(this.Sf,a))&&!(150>ta()-this.Ze)&&dg(this,a)};y.ai=function(a){27==a.keyCode&&dg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};y.wg=function(a){if(this.yh){var b=ie(this.q);if(Ua||Ta){if(a=b.activeElement,!a||ve(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>ta()-this.Ze||dg(this)}};y.P=function(){bg.j.P.call(this);this.Qa.Oa();Xb(this.ld);Xb(this.cd);delete this.q;delete this.Qa};function eg(a,b){this.Ne=a instanceof Vc?a:new Vc(a,b)}H(eg,$f);eg.prototype.Sa=function(a,b,c,d){Yf(of(a),0,a,b,this.Ne,c,p,d)};function fg(a,b){this.Ci=4;this.Zd=b||m;bg.call(this,a)}H(fg,bg);fg.prototype.Sa=function(){if(this.Zd){var a=!this.ra&&"move_offscreen"!=this.Dc,b=this.i();a&&(b.style.visibility="hidden",xf(b,n));this.Zd.Sa(b,this.Ci,this.gk);a&&xf(b,r)}};function gg(a,b,c){this.ab=c||(a?ge(je(a)):ge());fg.call(this,this.ab.tc("div",{style:"position:absolute;display:none;"}));this.Pe=new Vc(1,1);this.ac=new Sb;a&&hg(this,a);if(b!=p)if(a=this.i(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(ie(a).createTextNode(b))}}H(gg,fg);var ig=[];y=gg.prototype;y.qa=p;y.className="goog-tooltip";
y.Jg=500;y.Jh=0;y.Od=t("ab");function hg(a,b){b=je(b);a.ac.add(b);K(b,"mouseover",a.gg,r,a);K(b,"mouseout",a.Td,r,a);K(b,"mousemove",a.fg,r,a);K(b,"focus",a.eg,r,a);K(b,"blur",a.Td,r,a)}y.detach=function(a){if(a)a=je(a),jg(this,a),this.ac.remove(a);else{for(var b=this.ac.Pa(),c=0;a=b[c];c++)jg(this,a);this.ac.clear()}};function jg(a,b){tc(b,"mouseover",a.gg,r,a);tc(b,"mouseout",a.Td,r,a);tc(b,"mousemove",a.fg,r,a);tc(b,"focus",a.eg,r,a);tc(b,"blur",a.Td,r,a)}
y.mf=function(a){var b=this.i();b&&te(b);gg.j.mf.call(this,a);a&&(b=this.ab.Q.body,b.insertBefore(a,b.lastChild))};y.ff=function(){if(!bg.prototype.ff.call(this))return r;if(this.anchor)for(var a,b=0;a=ig[b];b++)ve(a.i(),this.anchor)||cg(a,r);0<=wb(ig,this)||ig.push(this);a=this.i();a.className=this.className;kg(this);K(a,"mouseover",this.ig,r,this);K(a,"mouseout",this.hg,r,this);lg(this);return n};
y.gf=function(){Bb(ig,this);for(var a=this.i(),b,c=0;b=ig[c];c++)b.anchor&&ve(a,b.anchor)&&cg(b,r);this.Eg&&mg(this.Eg);tc(a,"mouseover",this.ig,r,this);tc(a,"mouseout",this.hg,r,this);this.anchor=m;if(0==(this.lb?this.ra?4:1:this.wc?3:this.ra?2:0))this.ae=r;bg.prototype.gf.call(this)};y.ug=function(a,b){this.anchor==a&&this.ac.contains(this.anchor)&&(this.ae||!this.hk?(cg(this,r),this.ra||(this.anchor=a,this.Zd=b||ng(this,0)||m,this.ra&&this.Sa(),cg(this,n))):this.anchor=m);this.lb=m};
y.Xh=function(a){this.wc=m;a==this.anchor&&(this.qa==p||this.qa!=this.i()&&!this.ac.contains(this.qa))&&(!this.Tf||!this.Tf.qa)&&cg(this,r)};function og(a,b){var c=xe(a.ab);a.Pe.x=b.clientX+c.x;a.Pe.y=b.clientY+c.y}y.gg=function(a){var b=pg(this,a.target);this.qa=b;kg(this);b!=this.anchor&&(this.anchor=b,this.lb||(this.lb=Qf(ra(this.ug,this,b,m),this.Jg)),qg(this),og(this,a))};function pg(a,b){try{for(;b&&!a.ac.contains(b);)b=b.parentNode;return b}catch(c){return p}}
y.fg=function(a){og(this,a);this.ae=n};y.eg=function(a){this.qa=a=pg(this,a.target);this.ae=n;if(this.anchor!=a){this.anchor=a;var b=ng(this,1);kg(this);this.lb||(this.lb=Qf(ra(this.ug,this,a,b),this.Jg));qg(this)}};function ng(a,b){if(0==b){var c=a.Pe.f();return new rg(c)}return new sg(a.qa)}function qg(a){if(a.anchor)for(var b,c=0;b=ig[c];c++)ve(b.i(),a.anchor)&&(b.Tf=a,a.Eg=b)}
y.Td=function(a){var b=pg(this,a.target),c=pg(this,a.relatedTarget);b!=c&&(b==this.qa&&(this.qa=p),lg(this),this.ae=r,this.ra&&(!a.relatedTarget||!ve(this.i(),a.relatedTarget))?mg(this):this.anchor=m)};y.ig=function(){var a=this.i();this.qa!=a&&(kg(this),this.qa=a)};y.hg=function(a){var b=this.i();if(this.qa==b&&(!a.relatedTarget||!ve(b,a.relatedTarget)))this.qa=p,mg(this)};function lg(a){a.lb&&(Pf.clearTimeout(a.lb),a.lb=m)}
function mg(a){if(2==(a.lb?a.ra?4:1:a.wc?3:a.ra?2:0))a.wc=Qf(ra(a.Xh,a,a.anchor),a.Jh)}function kg(a){a.wc&&(Pf.clearTimeout(a.wc),a.wc=m)}y.P=function(){cg(this,r);lg(this);this.detach();this.i()&&te(this.i());this.qa=p;delete this.ab;gg.j.P.call(this)};function rg(a,b){eg.call(this,a,b)}H(rg,eg);rg.prototype.Sa=function(a,b,c){b=of(a);b=rf(b);c=c?new jf(c.top+10,c.right,c.bottom,c.left+10):new jf(10,0,0,10);Zf(this.Ne,a,4,c,b,9)&496&&Zf(this.Ne,a,4,c,b,5)};function sg(a){ag.call(this,a,3)}
H(sg,ag);sg.prototype.Sa=function(a,b,c){var d=new Vc(10,0);Yf(this.element,this.Wf,a,b,d,c,9)&496&&Yf(this.element,2,a,1,d,c,5)};function tg(a,b,c,d){B(a)||i(Error("No valid parent element."));(!E(b)||!E(c))&&i(Error("Invalid coordinates."));(!B(d)||!(d instanceof Y))&&i(Error("Invalid interactor."));gg.call(this);this.c="caption";this.oa=a;this.Fd=b;this.Gd=c;this.Nb=d;this.jb=p;this.Jb=[];this.Jb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];sc(d,Id,this.Ud.bind(this));this.We()}H(tg,gg);
tg.prototype.We=function(){if("static"==this.oa.style.position||""==this.oa.style.position)this.oa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=me("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Jb[0]);a.appendChild(b);b.appendChild(c);this.jb=b;this.Zd=new eg(this.Fd,this.Gd)||m;this.ra&&this.Sa();cg(this,n);hg(this,this.oa);this.i().classList.add("x-tooltip")};
tg.prototype.Ud=function(){cg(this,r);this.jb&&te(this.jb);this.i()&&te(this.i());this.jb=p};function ug(){Rf.call(this);this.c="renderer3D";this.Nc=this.Qc=this.Mc=this.Pc=this.Lc=this.Oc=this.Ae=this.Be=p;this.l=[0,0,0];this.Nf=p;this.fe=new Ob;this.Tc=new Ob;this.Cb=new Ob;this.yd=new Ob;this.jc=new Ob;this.pc=new Ob;this.qc=new Ob;this.rc=new Ob;this.K={PROGRESSBAR_ENABLED:n,PICKING_ENABLED:n,ORDERING_ENABLED:n,STATISTICS_ENABLED:r}}H(ug,Rf);ug.prototype.__defineGetter__("config",t("K"));y=ug.prototype;y.Li=function(){this.Nc=this.Qc=this.Mc=this.Pc=this.Lc=this.Oc=p;this.l=[0,0,0]};
y.hf=function(a){ug.j.hf.call(this,a);var b=a.Fd,a=a.Gd,c=this.get(this.Fg(b,a));if(c&&(c=c.ic))(new tg(this.t,this.t.offsetLeft+b+10,this.t.offsetTop+a+10,this.Nb)).i().innerHTML=c};
y.ja=function(){ug.j.ja.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.N,this.H),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.K.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.N,this.H,0,this.a.RGB,this.a.UNSIGNED_BYTE,p);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.N,this.H);this.a.bindRenderbuffer(this.a.RENDERBUFFER,p);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,p);this.Nf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}vg(this)};
function vg(a){var b=new Tf;(!B(a.ka)||!B(a.a)||!B(a.s))&&i(Error("Renderer was not initialized properly."));(!B(b)||!(b instanceof Tf))&&i(Error("Could not add shaders."));Wf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.sd);a.a.shaderSource(d,b.Dd);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.Ae=e;Object.keys(Uf).forEach(function(a){a=Uf[a];this.fe.set(a,this.a.getAttribLocation(this.Ae,a));this.a.enableVertexAttribArray(this.fe.get(a))}.bind(a));
Object.keys(Vf).forEach(function(a){a=Vf[a];this.Tc.set(a,this.a.getUniformLocation(this.Ae,a))}.bind(a));a.Be=b}
y.remove=function(a){if("undefined"!=typeof a){var b=a.ga;if(this.get(b)){if(0<a.d.length)for(var c=a.d,d=c.length,e=0,e=0;e<d;e++)this.remove(c[e]);c=this.qc.get(b);B(c)&&this.a.isBuffer(c.v)&&this.a.deleteBuffer(c.v);if(a.kk&&(c=this.rc.get(a.w.ga)))this.a.deleteTexture(c),this.rc.remove(a.w.ga);c=this.Cb.get(b);B(c)&&this.a.isBuffer(c.v)&&this.a.deleteBuffer(c.v);c=this.Cb.get(b);B(c)&&this.a.isBuffer(c.v)&&this.a.deleteBuffer(c.v);c=this.jc.get(b);B(c)&&this.a.isBuffer(c.v)&&this.a.deleteBuffer(c.v);
c=this.pc.get(b);B(c)&&this.a.isBuffer(c.v)&&this.a.deleteBuffer(c.v);this.Cb.remove(b);this.yd.remove(b);this.jc.remove(b);this.qc.remove(b);this.pc.remove(b);this.Xa.remove(a);return n}return r}};
y.fb=function(a){ug.j.fb.call(this,a);var b=r;this.get(a.ga)&&(b=n);var c=a.ga,d=a.g,e=a.h,f=a.Z,g=a.w,h=a.p,j=a.Zb,l=a.ca,k=a.n,o=a.u;if(B(k)&&B(k.p)&&k.p.e)this.fb(k);else if(B(k)&&k.e&&this.fb(k),B(l)&&B(l.p)&&l.p.e)this.C.load(l,a);else if(B(g)&&B(g.p)&&g.p.e)this.C.load(g,a);else{if(B(h)&&C(h))if(B(a.gc)){if(a.gc.Vd!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.C.load(h[b],a);return}else{if(B(h)&&h.e){this.C.load(a,a);return}if(B(o)&&B(o.p)&&o.p.e){this.C.load(o,a);return}}if(0<
a.d.length){h=a.d;l=h.length;for(k=k=0;k<l;k++)this.fb(h[k])}if(d){for(h=0;this.wd;)h++,window.console.log("Possible thread lock avoided: "+h);this.wd=n;l=a instanceof Ce&&a.kb instanceof Fe;b&&B(g)&&g.e&&(h=this.qc.get(c),B(h)&&this.a.isBuffer(h.v)&&this.a.deleteBuffer(h.v));h=p;B(g)&&(!b||g.e?(h=a.Yb,B(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=r,g.la&&(k=n),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),k=this.a.createTexture(),
k.Mh=g.ob,this.rc.set(g.ga,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.la?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,g.Za,g.Ya,0,this.a.RGB,this.a.UNSIGNED_BYTE,g.la):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.Mh),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),l?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,p),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Xf(k,h.length,2),g.e=r):h=this.qc.get(c));Ue(this.C,0.1);if(l)this.wd=
r,I.Ca(this.c+".update"),Ue(this.C,0.9);else{if(!b||d.e||j.e){l=j.D;g=l.Ra(new N(d.Rb,d.Sb,d.Tb));l=l.Ra(new N(d.Ob,d.Pb,d.Qb));if(this.Oc===p||g.x<this.Oc)this.Oc=g.x;if(this.Lc===p||l.x>this.Lc)this.Lc=l.x;if(this.Pc===p||g.y<this.Pc)this.Pc=g.y;if(this.Mc===p||l.y>this.Mc)this.Mc=l.y;if(this.Qc===p||g.b<this.Qc)this.Qc=g.b;if(this.Nc===p||l.b>this.Nc)this.Nc=l.b;this.l=[(this.Oc+this.Lc)/2,(this.Pc+this.Mc)/2,(this.Qc+this.Nc)/2];j.e=r}b&&d.e&&(j=this.Cb.get(c),B(j)&&this.a.isBuffer(j.v)&&this.a.deleteBuffer(j.v));
j=p;!b||d.e?(j=this.a.createBuffer(),d.Cc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,d.M,this.a.STATIC_DRAW),j=new Xf(j,d.count,3),d.e=r):j=this.Cb.get(c);Ue(this.C,0.3);b&&e.e&&(g=this.Cb.get(c),B(g)&&this.a.isBuffer(g.v)&&this.a.deleteBuffer(g.v));g=p;!b||e.e?(g=this.a.createBuffer(),e.Cc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.M,this.a.STATIC_DRAW),g=new Xf(g,e.count,3),e.e=r):g=this.yd.get(c);Ue(this.C,0.3);b&&f&&
f.e&&(e=this.jc.get(c),B(e)&&this.a.isBuffer(e.v)&&this.a.deleteBuffer(e.v));e=p;f&&(!b||f.e?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.Cc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.M,this.a.STATIC_DRAW),e=new Xf(e,f.count,3),f.e=r):e=this.jc.get(c));Ue(this.C,0.2);b&&o&&o.e&&(f=this.pc.get(c),B(f)&&this.a.isBuffer(f.v)&&this.a.deleteBuffer(f.v));f=p;o&&(f=o.Fc,!b||o.e?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),
d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Xf(d,f.length,3),o.e=r):f=this.pc.get(c));Ue(this.C,0.1);b||this.Xa.add(a);this.Cb.set(c,j);this.yd.set(c,g);this.jc.set(c,e);this.qc.set(c,h);this.pc.set(c,f);this.wd=a.e=r}}else a.e=r}};function wg(a,b){var c=b.g.qd,c=a.s.m.Ra(b.Zb.D.Ra(new N(c[0],c[1],c[2]))),c=Sc(a.s.ua,c);return Math.round(1E3*c)/1E3}
y.Fg=function(a,b){if(this.K.PICKING_ENABLED){this.Fb(n,r);var c=new Uint8Array(4);this.a.readPixels(a,this.H-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
y.Fb=function(a,b){ug.j.Fb.call(this,a,b);var c=this.Xa.r,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Nf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,p);this.a.viewport(0,0,this.N,this.H);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.s.Mf,f=this.s.Mb;this.a.uniformMatrix4fv(this.Tc.get("perspective"),r,e);this.a.uniformMatrix4fv(this.Tc.get("view"),r,f);e=this.l;this.a.uniform3f(this.Tc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.$a.length;for(e=0;e<f;++e){var g=this.$a[e];if(g instanceof M){var h=new N(1,0,0),h=this.s.m.Ra(h),j=Sc(this.s.ua,h),h=new N(-1,0,0),h=this.s.m.Ra(h),l=Sc(this.s.ua,h),h=new N(0,1,0),h=this.s.m.Ra(h),k=Sc(this.s.ua,h),h=new N(0,-1,0),h=this.s.m.Ra(h),o=Sc(this.s.ua,h),h=new N(0,0,1),h=this.s.m.Ra(h),v=Sc(this.s.ua,h),h=new N(0,0,-1),h=this.s.m.Ra(h),h=Sc(this.s.ua,h),q=Math.max(j,k,v,l,o,h);q==j||q==l?Ee(g,2):q==k||q==o?Ee(g,2):(q==v||q==h)&&Ee(g,2)}}if(this.K.ORDERING_ENABLED){j=r;f=this.$a;
g=f.length-1;do if(e=f[g],e instanceof M&&e.Ma){l=e.Db;j=e.S.d;1==l?j=e.T.d:2==l&&(j=e.ib.d);l=j.length;k=j[0];k.L=wg(this,k);k.aa=e.aa;o=j[l-1];o.L=wg(this,o);o.aa=e.aa;o=Math.round(1E3*((o.L-k.L)/l))/1E3;for(v=v=1;v<l-1;v++)h=Math.round(1E3*(k.L+v*o))/1E3,j[v].L=h,j[v].aa=e.aa;j=n}while(g--);f=this.Xa.r;g=f.length-1;do if(e=f[g],e.La&&!(1==e.aa||e instanceof Ce))e.L=wg(this,e),j=n;while(g--);j&&this.Xa.sort()}if(f=!a&&B(b)&&b&&this.K.STATISTICS_ENABLED)var w=0,u=0,z=0,D=0;var e=this.fe,g=e.get("vertexPosition"),
j=e.get("vertexNormal"),l=e.get("vertexColor"),k=e.get("vertexTexturePos"),o=e.get("vertexScalar"),e=this.Tc,v=e.get("usePicking"),h=e.get("useObjectColor"),q=e.get("objectColor"),x=e.get("useScalars"),A=e.get("scalarsReplaceMode"),F=e.get("scalarsMin"),J=e.get("scalarsMax"),T=e.get("scalarsMinColor"),O=e.get("scalarsMaxColor"),P=e.get("scalarsInterpolation"),fa=e.get("scalarsMinThreshold"),R=e.get("scalarsMaxThreshold"),aa=e.get("objectOpacity"),qa=e.get("labelmapOpacity"),Na=e.get("useTexture"),
U=e.get("useLabelMapTexture"),Ic=e.get("textureSampler"),pd=e.get("textureSampler2"),vb=e.get("volumeLowerThreshold"),qd=e.get("volumeUpperThreshold"),Mb=e.get("volumeScalarMin"),kb=e.get("volumeScalarMax"),Lb=e.get("volumeWindowLow"),Kc=e.get("volumeWindowHigh"),Ga=e.get("volumeScalarMinColor"),ub=e.get("volumeScalarMaxColor"),Jc=e.get("volumeTexture"),od=e.get("objectTransform"),xg=e.get("pointSize"),yg=e.get("rgbLowerThreshold"),zg=e.get("rgbUpperThreshold"),e=d;do{var Q=c[d-e];if(Q){var Z=p;Q instanceof
Ce&&Q.kb&&(Z=Q.kb);var Oa=p;Q instanceof Ce&&Q.Bd&&(Oa=Q.Bd);if(Q.La&&(!Z||Z.La)){var xa=Q.ga,Xa=Q.Kc,Ha=this.Cb.get(xa),gb=this.yd.get(xa),qe=this.jc.get(xa),re=this.pc.get(xa),se=this.qc.get(xa);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ha.v);this.a.vertexAttribPointer(g,Ha.tb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,gb.v);this.a.vertexAttribPointer(j,gb.tb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(v,n):this.a.uniform1i(v,r);qe&&!a&&!Xa?(this.a.uniform1i(h,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,
qe.v),this.a.vertexAttribPointer(l,qe.tb,this.a.FLOAT,r,0,0)):(gb=1,Xa&&!a&&(gb=0),this.a.uniform1i(h,gb),gb=Q.Ib,a&&(gb=[Math.floor(xa%65025%255)/255,Math.floor(xa%65025/255)/255,Math.floor(xa/65025)/255]),this.a.uniform3f(q,parseFloat(gb[0]),parseFloat(gb[1]),parseFloat(gb[2])),this.a.vertexAttribPointer(l,Ha.tb,this.a.FLOAT,r,0,0));re&&!a&&!Xa?(this.a.uniform1i(x,n),this.a.uniform1i(A,Q.u.Pf),xa=Q.u.xb,Xa=Q.u.vb,this.a.uniform3f(T,parseFloat(xa[0]),parseFloat(xa[1]),parseFloat(xa[2])),this.a.uniform3f(O,
parseFloat(Xa[0]),parseFloat(Xa[1]),parseFloat(Xa[2])),this.a.uniform1f(fa,parseFloat(Q.u.R)),this.a.uniform1f(R,parseFloat(Q.u.U)),this.a.uniform1f(F,parseFloat(Q.u.Ka)),this.a.uniform1f(J,parseFloat(Q.u.Da)),this.a.uniform1i(P,parseInt(Q.u.me,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,re.v),this.a.vertexAttribPointer(o,re.tb,this.a.FLOAT,r,0,0)):(this.a.uniform1i(x,r),this.a.vertexAttribPointer(o,Ha.tb,this.a.FLOAT,r,0,0));this.a.uniform1f(aa,parseFloat(Q.aa));Q.w&&se&&!a?(this.a.uniform1i(Na,n),
this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.rc.get(Q.w.ga)),this.a.uniform1i(Ic,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,se.v),this.a.vertexAttribPointer(k,se.tb,this.a.FLOAT,r,0,0),this.a.uniform1i(Jc,r),Oa&&(this.a.uniform3f(yg,parseFloat(Oa.xe),parseFloat(Oa.ke),parseFloat(Oa.ge)),this.a.uniform3f(zg,parseFloat(Oa.ye),parseFloat(Oa.le),parseFloat(Oa.he)))):(this.a.uniform1i(Na,r),this.a.vertexAttribPointer(k,Ha.tb,this.a.FLOAT,r,0,0));Z&&(this.a.uniform1i(Jc,
n),this.a.uniform1f(vb,Z.R),this.a.uniform1f(qd,Z.U),this.a.uniform1f(Mb,Z.Ka),this.a.uniform1f(kb,Z.Da),xa=Z.xb,Xa=Z.vb,this.a.uniform3f(Ga,parseFloat(xa[0]),parseFloat(xa[1]),parseFloat(xa[2])),this.a.uniform3f(ub,parseFloat(Xa[0]),parseFloat(Xa[1]),parseFloat(Xa[2])),this.a.uniform1f(Lb,Z.W),this.a.uniform1f(Kc,Z.V),Oa=Z.n,this.a.uniform1i(U,r),Z.Ma?this.a.uniform1f(aa,parseFloat(Z.aa)):Oa&&Oa.La&&(Z=Q.n.ga,this.a.uniform1i(U,n),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,
this.rc.get(Z)),this.a.uniform1i(pd,1),this.a.uniform1f(qa,Oa.aa)));this.a.uniformMatrix4fv(od,r,Q.Zb.Ef);Z=1;"POINTS"==Q.ma&&(Z=Q.Rc);this.a.uniform1f(xg,Z);Z=-1;Q.ma==rd?(Z=this.a.TRIANGLES,f&&(u+=Ha.sb/3)):"LINES"==Q.ma?(this.a.lineWidth(Q.nc),Z=this.a.LINES,f&&(z+=Ha.sb/2)):"POINTS"==Q.ma?(Z=this.a.POINTS,f&&(D+=Ha.sb)):"TRIANGLE_STRIPS"==Q.ma?(Z=this.a.TRIANGLE_STRIP,f&&(u+=Ha.sb/3)):"POLYGONS"==Q.ma&&(Z=0==Ha.sb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(u+=Ha.sb/3));f&&(w+=Ha.sb);this.a.drawArrays(Z,
0,Ha.sb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+w+" | ")+("Triangles: "+Math.round(u)+" | "),c=c+("Lines: "+z+" | ")+("Points: "+D+" | ")+("Textures: "+this.rc.bb()),window.console.log(c))}};y.Md=function(){this.Be=p;delete this.Be;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);ug.j.Md.call(this)};G("X.renderer3D",ug);G("X.renderer3D.prototype.init",ug.prototype.ja);G("X.renderer3D.prototype.add",ug.prototype.add);G("X.renderer3D.prototype.remove",ug.prototype.remove);
G("X.renderer3D.prototype.onShowtime",ug.prototype.Bg);G("X.renderer3D.prototype.onRender",ug.prototype.zg);G("X.renderer3D.prototype.get",ug.prototype.get);G("X.renderer3D.prototype.render",ug.prototype.fc);G("X.renderer3D.prototype.destroy",ug.prototype.Md);G("X.renderer3D.prototype.resetBoundingBox",ug.prototype.Li);G("X.renderer3D.prototype.resetViewAndRender",ug.prototype.Bc);G("X.renderer3D.prototype.pick",ug.prototype.Fg);function Ag(){M.call(this);this.c="stack";this.ge=this.ke=this.xe=0;this.he=this.le=this.ye=1}H(Ag,M);Ag.prototype.__defineSetter__("rLowerThreshold",s("xe"));Ag.prototype.__defineGetter__("rLowerThreshold",t("xe"));Ag.prototype.__defineSetter__("gLowerThreshold",s("ke"));Ag.prototype.__defineGetter__("gLowerThreshold",t("ke"));Ag.prototype.__defineSetter__("bLowerThreshold",s("ge"));Ag.prototype.__defineGetter__("bLowerThreshold",t("ge"));Ag.prototype.__defineSetter__("rUpperThreshold",s("ye"));
Ag.prototype.__defineGetter__("rUpperThreshold",t("ye"));Ag.prototype.__defineSetter__("gUpperThreshold",s("le"));Ag.prototype.__defineGetter__("gUpperThreshold",t("le"));Ag.prototype.__defineSetter__("bUpperThreshold",s("he"));Ag.prototype.__defineGetter__("bUpperThreshold",t("he"));G("X.stack",Ag);function Bg(){Rf.call(this);this.c="renderer2D";this.Ff=this.ne=this.Df=this.je=this.yb=p;this.Ad=this.Vb=this.Wb=this.Ce=this.De=0;this.V=this.W=this.U=this.R=this.Bf=-1}H(Bg,Rf);Bg.prototype.pi=ba();Bg.prototype.yi=ba();Bg.prototype.jf=function(a){Bg.j.jf.call(this,a);var b=this.$a[0];if(b){var c=this.yb;b["index"+c]=a.J?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
Bg.prototype.zi=function(a){var b=this.$a[0];if(b){var c=b.V-b.W,d=c/2,e=parseInt(c+c/15*-a.Ge,10),a=parseInt(d+d/15*a.se,10);c==e&&e++;d==a&&a++;b.W-=parseInt(d-a,10);b.W-=parseInt(c-e,10);b.W=Math.max(b.W,b.Ka);b.V-=parseInt(d-a,10);b.V+=parseInt(c-e,10);b.V=Math.min(b.V,b.Da);eval("this.onWindowLevel();")}};Bg.prototype.__defineGetter__("orientation",t("yb"));
Bg.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.yb=a});y=Bg.prototype;y.ja=function(){this.yb||i(Error("No 2D orientation set."));Bg.j.ja.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ka.width,this.ka.height);this.je=me("canvas");this.ne=me("canvas");K(this.s,Fd,this.zi.bind(this))};y.rotate=function(){this.Ad++};y.Mi=function(){this.Ad--};
y.Bc=function(){Bg.j.Bc.call(this);Cg(this);var a=this.$a[0];a&&(a.V=a.Da,a.W=a.Ka)};
y.fb=function(a){Bg.j.fb.call(this,a);var b=r;this.get(a.ga)&&(b=n);if(a instanceof M){var c=a.p,d=a.n,e=a.ca;if(B(d)&&B(d.p)&&d.p.e)this.fb(d);else if(B(e)&&B(e.p)&&e.p.e)this.C.load(e,a);else{if(B(c)&&C(c))if(B(a.gc)){if(a.gc.Vd!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.C.load(c[b],a);return}else if(B(c)&&c.e){this.C.load(a,a);return}var d=c=0,e=a.$,f=a.I;"X"==this.yb?(this.Xb=a.S.d,c=e[1],d=e[2],this.Wb=f[1],this.Vb=f[2]):"Y"==this.yb?(this.Xb=a.T.d,c=e[0],d=e[2],this.Wb=
f[0],this.Vb=f[2]):"Z"==this.yb&&(this.Xb=a.ib.d,c=e[0],d=e[1],this.Wb=f[0],this.Vb=f[1]);this.De=c;this.Ce=d;e=this.je;e.width=c;e.height=d;f=this.ne;f.width=c;f.height=d;this.Df=e.getContext("2d");this.Ff=f.getContext("2d");b||(this.Xa.add(a),Cg(this))}}};function Cg(a){a.s.m.k(2,3,Math.min(a.N/(a.De*a.Wb),a.H/(a.Ce*a.Vb)))}
y.Fb=function(a,b){Bg.j.Fb.call(this,a,b);if(0!=this.Xa.r.length){var c=this.N,d=this.H,e=this.s.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.Y(0,3),g=-1*e.Y(1,3),h=Math.max(e.Y(2,3),0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.$a[0],j=e["index"+this.yb],l=this.Xb[parseInt(j,10)],k=l.w.la,l=l.n,o=p;l&&(o=l.la);var v=this.De,q=this.Ce,w=this.Df,u=this.Ff,z=w.getImageData(0,0,v,q),D=u.getImageData(0,0,v,q),x=z.data,A=D.data,F=x.length,J=e.Da,T=e.R,O=e.U,P=e.W/J,fa=
e.V/J;if(this.Bf!=j||this.R!=T||this.U!=O||this.W!=P||this.V!=fa){var R=0;do{var aa=[0,0,0,0],qa=[0,0,0,0],Na=k[R]/255*J,U=k[R],U=(U/255-P)/(fa-P),U=255*U;Na>=T&&Na<=O&&(aa=new N(e.xb[0],e.xb[1],e.xb[2]),aa=(new N(e.vb[0],e.vb[1],e.vb[2])).scale(U).add(aa.scale(255-U)),aa=[Math.floor(aa.x),Math.floor(aa.y),Math.floor(aa.b),255],l&&(qa=[o[R],o[R+1],o[R+2],o[R+3]]));U=F-1-R;x[U-3]=aa[0];x[U-2]=aa[1];x[U-1]=aa[2];x[U]=aa[3];A[U-3]=qa[0];A[U-2]=qa[1];A[U-1]=qa[2];A[U]=qa[3];R+=4}while(R<F);w.putImageData(z,
0,0);u.putImageData(D,0,0);this.Bf=j;this.R=T;this.U=O;this.W=P;this.V=fa}this.a.globalAlpha=1;this.a.translate(c/2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.Ad);switch(this.Ad%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-v*this.Wb/2+f;g=-q*this.Vb/2+g;this.a.drawImage(this.je,f,g,v*this.Wb,q*this.Vb);l&&e.n.La&&(this.a.globalAlpha=e.n.aa,this.a.drawImage(this.ne,f,g,v*this.Wb,q*this.Vb))}};G("X.renderer2D",Bg);G("X.renderer2D.prototype.init",Bg.prototype.ja);
G("X.renderer2D.prototype.add",Bg.prototype.add);G("X.renderer2D.prototype.onShowtime",Bg.prototype.Bg);G("X.renderer2D.prototype.onRender",Bg.prototype.zg);G("X.renderer2D.prototype.onScroll",Bg.prototype.pi);G("X.renderer2D.prototype.onWindowLevel",Bg.prototype.yi);G("X.renderer2D.prototype.get",Bg.prototype.get);G("X.renderer2D.prototype.rotate",Bg.prototype.rotate);G("X.renderer2D.prototype.rotateCounter",Bg.prototype.Mi);G("X.renderer2D.prototype.resetViewAndRender",Bg.prototype.Bc);
G("X.renderer2D.prototype.render",Bg.prototype.fc);G("X.renderer2D.prototype.destroy",Bg.prototype.Md);function Dg(){V.call(this);this.c="fibers";va(this,new Pc)}H(Dg,V);G("X.fibers",Dg);function Eg(){V.call(this);this.c="mesh";va(this,new Pc)}H(Eg,V);G("X.mesh",Eg);
